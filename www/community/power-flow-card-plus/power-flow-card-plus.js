function t(t,e,o,i){var r,n=arguments.length,a=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(a=(n<3?r(a):n>3?r(e,o,a):r(e,o))||a);return n>3&&a&&Object.defineProperty(e,o,a),a}var e,o;function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t}).apply(this,arguments)}!function(t){t.language="language",t.system="system",t.comma_decimal="comma_decimal",t.decimal_comma="decimal_comma",t.space_comma="space_comma",t.none="none"}(e||(e={})),function(t){t.language="language",t.system="system",t.am_pm="12",t.twenty_four="24"}(o||(o={}));var r=function(t,o,i){var r=o?function(t){switch(t.number_format){case e.comma_decimal:return["en-US","en"];case e.decimal_comma:return["de","es","it"];case e.space_comma:return["fr","sv","cs"];case e.system:return;default:return t.language}}(o):void 0;if(Number.isNaN=Number.isNaN||function t(e){return"number"==typeof e&&t(e)},(null==o?void 0:o.number_format)!==e.none&&!Number.isNaN(Number(t))&&Intl)try{return new Intl.NumberFormat(r,n(t,i)).format(Number(t))}catch(e){return console.error(e),new Intl.NumberFormat(void 0,n(t,i)).format(Number(t))}return"string"==typeof t?t:function(t,e){return void 0===e&&(e=2),Math.round(t*Math.pow(10,e))/Math.pow(10,e)}(t,null==i?void 0:i.maximumFractionDigits).toString()+("currency"===(null==i?void 0:i.style)?" "+i.currency:"")},n=function(t,e){var o=i({maximumFractionDigits:2},e);if("string"!=typeof t)return o;if(!e||!e.minimumFractionDigits&&!e.maximumFractionDigits){var r=t.indexOf(".")>-1?t.split(".")[1].length:0;o.minimumFractionDigits=r,o.maximumFractionDigits=r}return o};const a=window,l=a.ShadowRoot&&(void 0===a.ShadyCSS||a.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s=Symbol(),d=new WeakMap;class c{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(l&&void 0===t){const o=void 0!==e&&1===e.length;o&&(t=d.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),o&&d.set(e,t))}return t}toString(){return this.cssText}}const u=(t,...e)=>{const o=1===t.length?t[0]:e.reduce(((e,o,i)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+t[i+1]),t[0]);return new c(o,t,s)},v=l?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const o of t.cssRules)e+=o.cssText;return(t=>new c("string"==typeof t?t:t+"",void 0,s))(e)})(t):t;var h;const y=window,p=y.trustedTypes,m=p?p.emptyScript:"",_=y.reactiveElementPolyfillSupport,f={toAttribute(t,e){switch(e){case Boolean:t=t?m:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let o=t;switch(e){case Boolean:o=null!==t;break;case Number:o=null===t?null:Number(t);break;case Object:case Array:try{o=JSON.parse(t)}catch(t){o=null}}return o}},g=(t,e)=>e!==t&&(e==e||t==t),b={attribute:!0,type:String,converter:f,reflect:!1,hasChanged:g};class w extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,o)=>{const i=this._$Ep(o,e);void 0!==i&&(this._$Ev.set(i,o),t.push(i))})),t}static createProperty(t,e=b){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const o="symbol"==typeof t?Symbol():"__"+t,i=this.getPropertyDescriptor(t,o,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}}static getPropertyDescriptor(t,e,o){return{get(){return this[e]},set(i){const r=this[t];this[e]=i,this.requestUpdate(t,r,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||b}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const o of e)this.createProperty(o,t[o])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const o=new Set(t.flat(1/0).reverse());for(const t of o)e.unshift(v(t))}else void 0!==t&&e.push(v(t));return e}static _$Ep(t,e){const o=e.attribute;return!1===o?void 0:"string"==typeof o?o:"string"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,o;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(o=t.hostConnected)||void 0===o||o.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t;const e=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,e)=>{l?t.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):e.forEach((e=>{const o=document.createElement("style"),i=a.litNonce;void 0!==i&&o.setAttribute("nonce",i),o.textContent=e.cssText,t.appendChild(o)}))})(e,this.constructor.elementStyles),e}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,o){this._$AK(t,o)}_$EO(t,e,o=b){var i;const r=this.constructor._$Ep(t,o);if(void 0!==r&&!0===o.reflect){const n=(void 0!==(null===(i=o.converter)||void 0===i?void 0:i.toAttribute)?o.converter:f).toAttribute(e,o.type);this._$El=t,null==n?this.removeAttribute(r):this.setAttribute(r,n),this._$El=null}}_$AK(t,e){var o;const i=this.constructor,r=i._$Ev.get(t);if(void 0!==r&&this._$El!==r){const t=i.getPropertyOptions(r),n="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(o=t.converter)||void 0===o?void 0:o.fromAttribute)?t.converter:f;this._$El=r,this[r]=n.fromAttribute(e,t.type),this._$El=null}}requestUpdate(t,e,o){let i=!0;void 0!==t&&(((o=o||this.constructor.getPropertyOptions(t)).hasChanged||g)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===o.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,o))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,e)=>this[e]=t)),this._$Ei=void 0);let e=!1;const o=this._$AL;try{e=this.shouldUpdate(o),e?(this.willUpdate(o),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(o)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(o)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,e)=>this._$EO(e,this[e],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}var $;w.finalized=!0,w.elementProperties=new Map,w.elementStyles=[],w.shadowRootOptions={mode:"open"},null==_||_({ReactiveElement:w}),(null!==(h=y.reactiveElementVersions)&&void 0!==h?h:y.reactiveElementVersions=[]).push("1.6.1");const x=window,k=x.trustedTypes,S=k?k.createPolicy("lit-html",{createHTML:t=>t}):void 0,E="$lit$",A=`lit$${(Math.random()+"").slice(9)}$`,C="?"+A,M=`<${C}>`,P=document,O=()=>P.createComment(""),T=t=>null===t||"object"!=typeof t&&"function"!=typeof t,G=Array.isArray,B="[ \t\n\f\r]",D=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,N=/-->/g,z=/>/g,R=RegExp(`>|${B}(?:([^\\s"'>=/]+)(${B}*=${B}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),j=/'/g,H=/"/g,F=/^(?:script|style|textarea|title)$/i,I=t=>(e,...o)=>({_$litType$:t,strings:e,values:o}),U=I(1),L=I(2),W=Symbol.for("lit-noChange"),V=Symbol.for("lit-nothing"),Z=new WeakMap,K=P.createTreeWalker(P,129,null,!1);class Y{constructor({strings:t,_$litType$:e},o){let i;this.parts=[];let r=0,n=0;const a=t.length-1,l=this.parts,[s,d]=((t,e)=>{const o=t.length-1,i=[];let r,n=2===e?"<svg>":"",a=D;for(let e=0;e<o;e++){const o=t[e];let l,s,d=-1,c=0;for(;c<o.length&&(a.lastIndex=c,s=a.exec(o),null!==s);)c=a.lastIndex,a===D?"!--"===s[1]?a=N:void 0!==s[1]?a=z:void 0!==s[2]?(F.test(s[2])&&(r=RegExp("</"+s[2],"g")),a=R):void 0!==s[3]&&(a=R):a===R?">"===s[0]?(a=null!=r?r:D,d=-1):void 0===s[1]?d=-2:(d=a.lastIndex-s[2].length,l=s[1],a=void 0===s[3]?R:'"'===s[3]?H:j):a===H||a===j?a=R:a===N||a===z?a=D:(a=R,r=void 0);const u=a===R&&t[e+1].startsWith("/>")?" ":"";n+=a===D?o+M:d>=0?(i.push(l),o.slice(0,d)+E+o.slice(d)+A+u):o+A+(-2===d?(i.push(void 0),e):u)}const l=n+(t[o]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==S?S.createHTML(l):l,i]})(t,e);if(this.el=Y.createElement(s,o),K.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(i=K.nextNode())&&l.length<a;){if(1===i.nodeType){if(i.hasAttributes()){const t=[];for(const e of i.getAttributeNames())if(e.endsWith(E)||e.startsWith(A)){const o=d[n++];if(t.push(e),void 0!==o){const t=i.getAttribute(o.toLowerCase()+E).split(A),e=/([.?@])?(.*)/.exec(o);l.push({type:1,index:r,name:e[2],strings:t,ctor:"."===e[1]?tt:"?"===e[1]?ot:"@"===e[1]?it:X})}else l.push({type:6,index:r})}for(const e of t)i.removeAttribute(e)}if(F.test(i.tagName)){const t=i.textContent.split(A),e=t.length-1;if(e>0){i.textContent=k?k.emptyScript:"";for(let o=0;o<e;o++)i.append(t[o],O()),K.nextNode(),l.push({type:2,index:++r});i.append(t[e],O())}}}else if(8===i.nodeType)if(i.data===C)l.push({type:2,index:r});else{let t=-1;for(;-1!==(t=i.data.indexOf(A,t+1));)l.push({type:7,index:r}),t+=A.length-1}r++}}static createElement(t,e){const o=P.createElement("template");return o.innerHTML=t,o}}function q(t,e,o=t,i){var r,n,a,l;if(e===W)return e;let s=void 0!==i?null===(r=o._$Co)||void 0===r?void 0:r[i]:o._$Cl;const d=T(e)?void 0:e._$litDirective$;return(null==s?void 0:s.constructor)!==d&&(null===(n=null==s?void 0:s._$AO)||void 0===n||n.call(s,!1),void 0===d?s=void 0:(s=new d(t),s._$AT(t,o,i)),void 0!==i?(null!==(a=(l=o)._$Co)&&void 0!==a?a:l._$Co=[])[i]=s:o._$Cl=s),void 0!==s&&(e=q(t,s._$AS(t,e.values),s,i)),e}class J{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var e;const{el:{content:o},parts:i}=this._$AD,r=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:P).importNode(o,!0);K.currentNode=r;let n=K.nextNode(),a=0,l=0,s=i[0];for(;void 0!==s;){if(a===s.index){let e;2===s.type?e=new Q(n,n.nextSibling,this,t):1===s.type?e=new s.ctor(n,s.name,s.strings,this,t):6===s.type&&(e=new rt(n,this,t)),this._$AV.push(e),s=i[++l]}a!==(null==s?void 0:s.index)&&(n=K.nextNode(),a++)}return r}v(t){let e=0;for(const o of this._$AV)void 0!==o&&(void 0!==o.strings?(o._$AI(t,o,e),e+=o.strings.length-2):o._$AI(t[e])),e++}}class Q{constructor(t,e,o,i){var r;this.type=2,this._$AH=V,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=o,this.options=i,this._$Cp=null===(r=null==i?void 0:i.isConnected)||void 0===r||r}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===(null==t?void 0:t.nodeType)&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=q(this,t,e),T(t)?t===V||null==t||""===t?(this._$AH!==V&&this._$AR(),this._$AH=V):t!==this._$AH&&t!==W&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):(t=>G(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator]))(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==V&&T(this._$AH)?this._$AA.nextSibling.data=t:this.$(P.createTextNode(t)),this._$AH=t}g(t){var e;const{values:o,_$litType$:i}=t,r="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=Y.createElement(i.h,this.options)),i);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.v(o);else{const t=new J(r,this),e=t.u(this.options);t.v(o),this.$(e),this._$AH=t}}_$AC(t){let e=Z.get(t.strings);return void 0===e&&Z.set(t.strings,e=new Y(t)),e}T(t){G(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let o,i=0;for(const r of t)i===e.length?e.push(o=new Q(this.k(O()),this.k(O()),this,this.options)):o=e[i],o._$AI(r),i++;i<e.length&&(this._$AR(o&&o._$AB.nextSibling,i),e.length=i)}_$AR(t=this._$AA.nextSibling,e){var o;for(null===(o=this._$AP)||void 0===o||o.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cp=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class X{constructor(t,e,o,i,r){this.type=1,this._$AH=V,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=r,o.length>2||""!==o[0]||""!==o[1]?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=V}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,o,i){const r=this.strings;let n=!1;if(void 0===r)t=q(this,t,e,0),n=!T(t)||t!==this._$AH&&t!==W,n&&(this._$AH=t);else{const i=t;let a,l;for(t=r[0],a=0;a<r.length-1;a++)l=q(this,i[o+a],e,a),l===W&&(l=this._$AH[a]),n||(n=!T(l)||l!==this._$AH[a]),l===V?t=V:t!==V&&(t+=(null!=l?l:"")+r[a+1]),this._$AH[a]=l}n&&!i&&this.j(t)}j(t){t===V?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class tt extends X{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===V?void 0:t}}const et=k?k.emptyScript:"";class ot extends X{constructor(){super(...arguments),this.type=4}j(t){t&&t!==V?this.element.setAttribute(this.name,et):this.element.removeAttribute(this.name)}}class it extends X{constructor(t,e,o,i,r){super(t,e,o,i,r),this.type=5}_$AI(t,e=this){var o;if((t=null!==(o=q(this,t,e,0))&&void 0!==o?o:V)===W)return;const i=this._$AH,r=t===V&&i!==V||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,n=t!==V&&(i===V||r);r&&this.element.removeEventListener(this.name,this,i),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,o;"function"==typeof this._$AH?this._$AH.call(null!==(o=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==o?o:this.element,t):this._$AH.handleEvent(t)}}class rt{constructor(t,e,o){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(t){q(this,t)}}const nt=x.litHtmlPolyfillSupport;var at,lt;null==nt||nt(Y,Q),(null!==($=x.litHtmlVersions)&&void 0!==$?$:x.litHtmlVersions=[]).push("2.7.2");class st extends w{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const o=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=o.firstChild),o}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,o)=>{var i,r;const n=null!==(i=null==o?void 0:o.renderBefore)&&void 0!==i?i:e;let a=n._$litPart$;if(void 0===a){const t=null!==(r=null==o?void 0:o.renderBefore)&&void 0!==r?r:null;n._$litPart$=a=new Q(e.insertBefore(O(),t),t,void 0,null!=o?o:{})}return a._$AI(t),a})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return W}}st.finalized=!0,st._$litElement$=!0,null===(at=globalThis.litElementHydrateSupport)||void 0===at||at.call(globalThis,{LitElement:st});const dt=globalThis.litElementPolyfillSupport;null==dt||dt({LitElement:st}),(null!==(lt=globalThis.litElementVersions)&&void 0!==lt?lt:globalThis.litElementVersions=[]).push("3.3.1");const ct=t=>e=>"function"==typeof e?((t,e)=>(customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:o,elements:i}=e;return{kind:o,elements:i,finisher(e){customElements.define(t,e)}}})(t,e),ut=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(o){o.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(o){o.createProperty(e.key,t)}};function vt(t){return(e,o)=>void 0!==o?((t,e,o)=>{e.constructor.createProperty(o,t)})(t,e,o):ut(t,e)}function ht(t){return vt({...t,state:!0})}function yt(t,e){return(({finisher:t,descriptor:e})=>(o,i)=>{var r;if(void 0===i){const i=null!==(r=o.originalKey)&&void 0!==r?r:o.key,n=null!=e?{kind:"method",placement:"prototype",key:i,descriptor:e(o.key)}:{...o,key:i};return null!=t&&(n.finisher=function(e){t(e,i)}),n}{const r=o.constructor;void 0!==e&&Object.defineProperty(o,i,e(i)),null==t||t(r,i)}})({descriptor:o=>{const i={get(){var e,o;return null!==(o=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==o?o:null},enumerable:!0,configurable:!0};if(e){const e="symbol"==typeof o?Symbol():"__"+o;i.get=function(){var o,i;return void 0===this[e]&&(this[e]=null!==(i=null===(o=this.renderRoot)||void 0===o?void 0:o.querySelector(t))&&void 0!==i?i:null),this[e]}}return i}})}var pt;null===(pt=window.HTMLSlotElement)||void 0===pt||pt.prototype.assignedElements;class mt{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,o){this._$Ct=t,this._$AM=e,this._$Ci=o}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}const _t=(t=>(...e)=>({_$litDirective$:t,values:e}))(class extends mt{constructor(t){var e;if(super(t),1!==t.type||"class"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){var o,i;if(void 0===this.it){this.it=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(const t in e)e[t]&&!(null===(o=this.nt)||void 0===o?void 0:o.has(t))&&this.it.add(t);return this.render(e)}const r=t.element.classList;this.it.forEach((t=>{t in e||(r.remove(t),this.it.delete(t))}));for(const t in e){const o=!!e[t];o===this.it.has(t)||(null===(i=this.nt)||void 0===i?void 0:i.has(t))||(o?(r.add(t),this.it.add(t)):(r.remove(t),this.it.delete(t)))}return W}}),ft=(t,e)=>Number(`${Math.round(Number(`${t}e${e}`))}e-${e}`);function gt(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}function bt(t,e=0){return gt(t)?Number(t):e}var wt="0.1.4";console.groupCollapsed(`%c⚡ Power Flow Card Plus v${wt} is installed`,"color: #488fc2; font-weight: bold"),console.log("Readme:","https://github.com/flixlix/power-flow-card-plus"),console.groupEnd();const $t=function(t,e,o){var i;return void 0===o&&(o=!1),function(){var e=[].slice.call(arguments),r=this,n=o&&!i;clearTimeout(i),i=setTimeout((function(){i=null,o||t.apply(r,e)}),6e4),n&&t.apply(r,e)}}((t=>{console.log(`%c⚡ Power Flow Card Plus v${wt} %cError: ${t}`,"color: #488fc2; font-weight: bold","color: #b33a3a; font-weight: normal")})),xt=u`:host{--mdc-icon-size:24px;--clickable-cursor:pointer;--individualone-color:#d0cc5b;--individualtwo-color:#964cb5;--non-fossil-color:var(--energy-non-fossil-color, #0f9d58);--icon-non-fossil-color:var(--non-fossil-color, #0f9d58);--icon-solar-color:var(--energy-solar-color, #ff9800);--icon-individualone-color:var(--individualone-color, #d0cc5b);--icon-individualtwo-color:var(--individualtwo-color, #964cb5);--icon-grid-color:var(--energy-grid-consumption-color, #488fc2);--icon-battery-color:var(--energy-battery-in-color, #f06292);--icon-home-color:var(--energy-grid-consumption-color, #488fc2);--text-solar-color:var(--primary-text-color);--text-non-fossil-color:var(--primary-text-color);--text-individualone-color:var(--primary-text-color);--text-individualtwo-color:var(--primary-text-color);--text-home-color:var(--primary-text-color);--secondary-text-individualone-color:var(--primary-text-color);--secondary-text-individualtwo-color:var(--primary-text-color);--text-battery-state-of-charge-color:var(--primary-text-color);--cirlce-grid-color:var(--energy-grid-consumption-color, #488fc2);--circle-battery-color:var(--energy-battery-in-color, #f06292);--secondary-text-solar-color:var(--primary-text-color);--secondary-text-grid-color:var(--primary-text-color);--secondary-text-home-color:var(--primary-text-color);--secondary-text-non-fossil-color:var(--primary-text-color);--lines-svg-not-flat-line-height:106%;--lines-svg-not-flat-line-top:-3%}.card-content{position:relative;margin:0 auto}.card-content,.row{max-width:470px}.lines{position:absolute;bottom:0;left:0;width:100%;height:146px;display:flex;justify-content:center;padding:0 16px 16px;box-sizing:border-box}.lines.individual1-individual2{bottom:110px}.lines.high{bottom:100px;height:156px}.lines svg{width:calc(100% - 160px);height:100%;max-width:340px}.lines svg:not(.flat-line){width:calc(103% - 165px);height:var(--lines-svg-not-flat-line-height);top:var(--lines-svg-not-flat-line-top);position:relative}.row{display:flex;justify-content:space-between;max-width:500px;margin:0 auto}.circle-container{display:flex;flex-direction:column;align-items:center;z-index:2}.circle-container.solar{margin:0 4px;height:130px}.circle-container.individual2{margin-left:4px;height:130px}.circle-container.individual1{margin-left:4px;height:130px}.circle-container.individual1.bottom{position:relative;top:-20px;margin-bottom:-20px}.circle-container.battery{height:110px;justify-content:flex-end}.spacer{width:84px}.circle{width:80px;height:80px;border-radius:50%;box-sizing:border-box;border:2px solid;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;font-size:12px;line-height:12px;position:relative;text-decoration:none;color:var(--primary-text-color)}.circle-container .circle{cursor:var(--clickable-cursor)}#battery-grid{stroke:var(--energy-grid-return-color)}ha-icon{padding-bottom:2px}ha-icon.small{--mdc-icon-size:12px}.label{color:var(--secondary-text-color);font-size:12px;max-width:80px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;min-height:20px}line,path{stroke:var(--disabled-text-color);stroke-width:1;fill:none}.circle svg{position:absolute;fill:none;stroke-width:4px;width:100%;height:100%;top:0;left:0}span.secondary-info{color:var(--primary-text-color);font-size:12px;max-width:60px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.individual2 circle,.individual2 path{stroke:var(--individualtwo-color)}#individual1-icon{color:var(--icon-individualone-color)}#individual2-icon{color:var(--icon-individualtwo-color)}#solar-icon{color:var(--icon-solar-color)}circle.individual2{stroke-width:4;fill:var(--individualtwo-color)}.individual2 .circle{border-color:var(--individualtwo-color)}.individual1 circle,.individual1 path{stroke:var(--individualone-color)}circle.individual1{stroke-width:4;fill:var(--individualone-color)}.individual1 .circle{border-color:var(--individualone-color)}.circle-container.low-carbon{margin-right:4px;height:130px}.low-carbon path{stroke:var(--non-fossil-color)}.low-carbon .circle{border-color:var(--non-fossil-color)}.low-carbon ha-icon:not(.small){color:var(--icon-non-fossil-color)}circle.low-carbon{stroke-width:4;fill:var(--non-fossil-color);stroke:var(--non-fossil-color)}.solar{color:var(--primary-text-color)}.solar .circle{border-color:var(--energy-solar-color)}.solar ha-icon:not(.small){color:var(--icon-solar-color)}circle.solar,path.solar{stroke:var(--energy-solar-color)}circle.solar{stroke-width:4;fill:var(--energy-solar-color)}.battery .circle{border-color:var(--circle-battery-color)}circle.battery,path.battery{stroke:var(--energy-battery-out-color)}circle.battery-home,path.battery-home{stroke:var(--energy-battery-out-color)}circle.battery-home{stroke-width:4;fill:var(--energy-battery-out-color)}circle.battery-solar,path.battery-solar{stroke:var(--energy-battery-in-color)}circle.battery-solar{stroke-width:4;fill:var(--energy-battery-in-color)}.battery-in{color:var(--energy-battery-in-color)}.battery-out{color:var(--energy-battery-out-color)}path.battery-from-grid{stroke:var(--energy-grid-consumption-color)}path.battery-to-grid{stroke:var(--energy-grid-return-color)}.battery ha-icon:not(.small){color:var(--icon-battery-color)}circle.battery-to-grid,circle.return,path.return{stroke:var(--energy-grid-return-color)}circle.battery-to-grid,circle.return{stroke-width:4;fill:var(--energy-grid-return-color)}.return{color:var(--energy-grid-return-color)}.grid .circle{border-color:var(--circle-grid-color)}.consumption{color:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid,path.grid{stroke:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid{stroke-width:4;fill:var(--energy-grid-consumption-color)}.grid ha-icon:not(.small){color:var(--icon-grid-color)}.home .circle{border-width:0;border-color:var(--primary-color)}.home .circle.border{border-width:2px}.home ha-icon:not(.small){color:var(--icon-home-color)}.circle svg circle{animation:rotate-in .6s ease-in;transition:stroke-dashoffset .4s,stroke-dasharray .4s;fill:none}span.solar{color:var(--text-solar-color)}span.low-carbon{color:var(--text-non-fossil-color)}span.low-carbon.secondary-info{color:var(--secondary-text-non-fossil-color)}#home-circle{color:var(--text-home-color)}.individual1 .circle{color:var(--text-individualone-color)}.individual2 .circle{color:var(--text-individualtwo-color)}.individual1 span.secondary-info{color:var(--secondary-text-individualone-color)}.individual2 span.secondary-info{color:var(--secondary-text-individualtwo-color)}.solar span.secondary-info{color:var(--secondary-text-solar-color)}.grid span.secondary-info{color:var(--secondary-text-grid-color)}.home span.secondary-info{color:var(--secondary-text-home-color)}#battery-state-of-charge-text{color:var(--text-battery-state-of-charge-color)}@keyframes rotate-in{from{stroke-dashoffset:238.76104;stroke-dasharray:238.76104}}.card-actions a{text-decoration:none}.home-circle-sections{pointer-events:none}`,kt=238.76104;!function(t){const e=window;e.customCards=e.customCards||[],e.customCards.push(Object.assign(Object.assign({},{type:"power-flow-card-plus",name:"Power Flow Card Plus",description:"An extended version of the power flow card with richer options, advanced features and a few small UI enhancements. Inspired by the Energy Dashboard."}),{preview:!0,documentationURL:"https://github.com/flixlix/power-flow-card-plus"}))}();let St=class extends st{constructor(){super(...arguments),this._config={},this._templateResults={},this._unsubRenderTemplates=new Map,this.unavailableOrMisconfiguredError=t=>$t(`Entity "${null!=t?t:"Unknown"}" is not available or misconfigured`),this.entityExists=t=>t in this.hass.states,this.entityAvailable=t=>{var e;return gt(null===(e=this.hass.states[t])||void 0===e?void 0:e.state)},this.entityInverted=t=>{var e;return!!(null===(e=this._config.entities[t])||void 0===e?void 0:e.invert_state)},this.previousDur={},this.circleRate=(t,e)=>{var o,i;if(this._config.use_new_flow_rate_model){const e=this._config.max_expected_power,o=this._config.min_expected_power,i=this._config.max_flow_rate,r=this._config.min_flow_rate;return this.mapRange(t,i,r,o,e)}const r=null===(o=this._config)||void 0===o?void 0:o.min_flow_rate,n=null===(i=this._config)||void 0===i?void 0:i.max_flow_rate;return n-t/(e>0?e:t)*(n-r)},this.getEntityStateObj=t=>{if(t&&this.entityAvailable(t))return this.hass.states[t];this.unavailableOrMisconfiguredError(t)},this.additionalCircleRate=(t,e)=>!0===t&&e?e:gt(t)?t:1.66,this.getEntityState=t=>t&&this.entityAvailable(t)?bt(this.hass.states[t].state):(this.unavailableOrMisconfiguredError(t),0),this.getEntityStateWatts=t=>{var e;if(!t||!this.entityAvailable(t))return this.unavailableOrMisconfiguredError(t),0;const o=this.hass.states[t],i=bt(o.state);return(null===(e=o.attributes.unit_of_measurement)||void 0===e?void 0:e.toUpperCase().startsWith("KW"))?1e3*i:i},this.displayNonFossilState=(t,e)=>{var o,i,r,n,a,l,s;if(!t||!this.entityAvailable(t))return this.unavailableOrMisconfiguredError(t),"NaN";const d=null===(i=null===(o=this._config.entities.fossil_fuel_percentage)||void 0===o?void 0:o.unit_white_space)||void 0===i||i,c="percentage"===(null===(r=this._config.entities.fossil_fuel_percentage)||void 0===r?void 0:r.state_type)?"%":"W",u=1-this.getEntityState(t)/100;let v,h;v="string"==typeof(null===(n=this._config.entities.grid)||void 0===n?void 0:n.entity)?e:this.getEntityStateWatts(null===(a=this._config.entities.grid)||void 0===a?void 0:a.entity.consumption)||0;const y=null!==(s=null===(l=this._config.entities.fossil_fuel_percentage)||void 0===l?void 0:l.display_zero_tolerance)&&void 0!==s?s:0;if("W"===c){let t=v*u;y&&t<y&&(t=0),h=this.displayValue(t,void 0,d)}else{let e=100-this.getEntityState(t);y&&e<y&&(e=0),h=this.displayValue(e,c,d,0)}return h},this.displayValue=(t,e,o,i)=>{if(null===t)return"0";if(Number.isNaN(+t))return t.toString();const n=Number(t),a=void 0===e&&n>=this._config.watt_threshold;return`${r(a?ft(n/1e3,this._config.kw_decimals):ft(n,null!=i?i:this._config.w_decimals),this.hass.locale)}${!1===o?"":" "}${e||(a?"kW":"W")}`}}setConfig(t){var e,o,i,r,n,a;if(!t.entities||!(null===(o=null===(e=t.entities)||void 0===e?void 0:e.battery)||void 0===o?void 0:o.entity)&&!(null===(r=null===(i=t.entities)||void 0===i?void 0:i.grid)||void 0===r?void 0:r.entity)&&!(null===(a=null===(n=t.entities)||void 0===n?void 0:n.solar)||void 0===a?void 0:a.entity))throw new Error("At least one entity for battery, grid or solar must be defined");this._config=Object.assign(Object.assign({},t),{kw_decimals:bt(t.kw_decimals,1),min_flow_rate:bt(t.min_flow_rate,.75),max_flow_rate:bt(t.max_flow_rate,6),w_decimals:bt(t.w_decimals,0),watt_threshold:bt(t.watt_threshold,1e3),max_expected_power:bt(t.max_expected_power,2e3),min_expected_power:bt(t.min_expected_power,.01)})}connectedCallback(){super.connectedCallback(),this._tryConnectAll()}disconnectedCallback(){this._tryDisconnectAll()}static async getConfigElement(){return await Promise.resolve().then((function(){return de})),document.createElement("power-flow-card-plus-editor")}static getStubConfig(t){return function(t){function e(e,o){const i=t.states[e].attributes.friendly_name;return o.some((t=>e.includes(t)||(null==i?void 0:i.includes(t))))}const o=Object.keys(t.states).filter((e=>{const o=t.states[e];return o.state&&o.attributes&&"power"===o.attributes.device_class||o.entity_id.includes("power")})),i=["grid","utility","net","meter"],r=["solar","pv","photovoltaic","inverter"],n=["battery"],a=["battery_percent","battery_level","state_of_charge","soc","percentage"],l=o.filter((t=>e(t,i)))[0],s=o.filter((t=>e(t,r)))[0],d=o.filter((t=>e(t,n)))[0],c=Object.keys(t.states).filter((e=>{const o=t.states[e];return o&&o.state&&o.attributes&&"%"===o.attributes.unit_of_measurement})).filter((t=>e(t,a)))[0];return{entities:{battery:{entity:null!=d?d:"",state_of_charge:null!=c?c:""},grid:l?{entity:l}:void 0,solar:s?{entity:s,display_zero_state:!0}:void 0},clickable_entities:!0,display_zero_lines:!0,use_new_flow_rate_model:!0,w_decimals:0,kw_decimals:1,min_flow_rate:.75,max_flow_rate:6,max_expected_power:2e3,min_expected_power:.01,watt_threshold:1e3}}(t)}getCardSize(){return 3}mapRange(t,e,o,i,r){return t>r?o:(t-i)*(o-e)/(r-i)+e}openDetails(t,e){if(t.stopPropagation(),!e||!this._config.clickable_entities)return;if(!this.entityExists(e))return;const o=new CustomEvent("hass-more-info",{composed:!0,detail:{entityId:e}});this.dispatchEvent(o)}hasField(t,e){var o,i;return!!(void 0!==t&&!0===(null==t?void 0:t.display_zero)||this.getEntityStateWatts(null==t?void 0:t.entity)>(null!==(o=null==t?void 0:t.display_zero_tolerance)&&void 0!==o?o:0)&&this.entityAvailable(null==t?void 0:t.entity)||e)&&"string"==typeof(null===(i=this.hass.states[null==t?void 0:t.entity])||void 0===i?void 0:i.state)}showLine(t){var e;return!1!==(null===(e=this._config)||void 0===e?void 0:e.display_zero_lines)||t>0}computeFieldIcon(t,e){var o,i;return(null==t?void 0:t.icon)?t.icon:(null==t?void 0:t.use_metadata)?(null===(i=null===(o=this.getEntityStateObj(t.entity))||void 0===o?void 0:o.attributes)||void 0===i?void 0:i.icon)||"":e}computeFieldName(t,e){var o,i;return(null==t?void 0:t.name)?t.name:(null==t?void 0:t.use_metadata)?(null===(i=null===(o=this.getEntityStateObj(t.entity))||void 0===o?void 0:o.attributes)||void 0===i?void 0:i.friendly_name)||"":e}convertColorListToHex(t){return"#".concat(t.map((t=>t.toString(16).padStart(2,"0"))).join(""))}render(){var t,e,o,i,r,n,a,l,s,d,c,u,v,h,y,p,m,_,f,g,b,w,$,x,k,S,E,A,C,M,P,O,T,G,B,D,N,z,R,j,H,F,I,W,V,Z,K,Y,q,J,Q,X,tt,et,ot,it,rt,nt,at,lt,st,dt,ct,ut,vt,ht,yt,pt,mt,ft,wt,$t,xt,St,Et,At,Ct,Mt,Pt,Ot,Tt,Gt,Bt,Dt,Nt,zt,Rt,jt,Ht,Ft,It,Ut,Lt,Wt,Vt,Zt,Kt,Yt,qt,Jt,Qt,Xt,te,ee,oe,ie,re,ne,ae,le,se,de,ce,ue,ve,he,ye,pe,me,_e,fe,ge,be,we,$e,xe,ke,Se,Ee,Ae,Ce,Me,Pe,Oe,Te,Ge,Be,De,Ne,ze,Re,je,He,Fe,Ie,Ue,Le,We,Ve,Ze,Ke,Ye,qe,Je,Qe,Xe,to,eo,oo,io,ro,no,ao,lo,so,co,uo,vo,ho,yo,po,mo,_o,fo,go,bo,wo,$o,xo,ko,So,Eo,Ao,Co,Mo,Po,Oo,To,Go,Bo,Do,No,zo,Ro,jo,Ho,Fo,Io,Uo,Lo,Wo,Vo,Zo,Ko,Yo,qo,Jo,Qo,Xo,ti,ei,oi,ii,ri,ni,ai,li,si,di,ci,ui,vi,hi,yi,pi,mi,_i,fi,gi,bi,wi,$i,xi,ki,Si,Ei,Ai,Ci;if(!this._config||!this.hass)return U``;const{entities:Mi}=this._config;this.style.setProperty("--clickable-cursor",this._config.clickable_entities?"pointer":"default");const Pi={entity:null===(t=Mi.grid)||void 0===t?void 0:t.entity,has:void 0!==(null===(e=null==Mi?void 0:Mi.grid)||void 0===e?void 0:e.entity),hasReturnToGrid:"string"==typeof(null===(o=Mi.grid)||void 0===o?void 0:o.entity)||(null===(r=null===(i=Mi.grid)||void 0===i?void 0:i.entity)||void 0===r?void 0:r.production),state:{fromGrid:null,toGrid:null,toBattery:null},powerOutage:{has:this.hasField(null===(n=Mi.grid)||void 0===n?void 0:n.power_outage,!0),isOutage:(Mi.grid&&(null===(l=this.hass.states[null===(a=Mi.grid.power_outage)||void 0===a?void 0:a.entity])||void 0===l?void 0:l.state))===(null!==(c=null===(d=null===(s=Mi.grid)||void 0===s?void 0:s.power_outage)||void 0===d?void 0:d.state_alert)&&void 0!==c?c:"on")},icon:this.computeFieldIcon(Mi.grid,"mdi:transmission-tower"),name:this.computeFieldName(Mi.grid,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.grid")),mainEntity:"object"==typeof(null===(u=Mi.grid)||void 0===u?void 0:u.entity)?Mi.grid.entity.consumption||Mi.grid.entity.production:null===(v=Mi.grid)||void 0===v?void 0:v.entity,color:{fromGrid:null===(y=null===(h=Mi.grid)||void 0===h?void 0:h.color)||void 0===y?void 0:y.consumption,toGrid:null===(m=null===(p=Mi.grid)||void 0===p?void 0:p.color)||void 0===m?void 0:m.production,icon_type:null===(_=Mi.grid)||void 0===_?void 0:_.color_icon,circle_type:null===(f=Mi.grid)||void 0===f?void 0:f.color_circle},secondary:{entity:null===(b=null===(g=Mi.grid)||void 0===g?void 0:g.secondary_info)||void 0===b?void 0:b.entity,has:this.hasField(null===(w=Mi.grid)||void 0===w?void 0:w.secondary_info),state:null,icon:null===(x=null===($=Mi.grid)||void 0===$?void 0:$.secondary_info)||void 0===x?void 0:x.icon,unit:null===(S=null===(k=Mi.grid)||void 0===k?void 0:k.secondary_info)||void 0===S?void 0:S.unit_of_measurement,unit_white_space:null===(A=null===(E=Mi.grid)||void 0===E?void 0:E.secondary_info)||void 0===A?void 0:A.unit_white_space,color:{type:null===(M=null===(C=Mi.grid)||void 0===C?void 0:C.secondary_info)||void 0===M?void 0:M.color_value}}},Oi={entity:null===(P=Mi.solar)||void 0===P?void 0:P.entity,has:void 0!==(null===(O=Mi.solar)||void 0===O?void 0:O.entity),state:{total:null,toHome:null,toGrid:null,toBattery:null},icon:this.computeFieldIcon(Mi.solar,"mdi:solar-power"),name:this.computeFieldName(Mi.solar,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.solar")),secondary:{entity:null===(G=null===(T=Mi.solar)||void 0===T?void 0:T.secondary_info)||void 0===G?void 0:G.entity,has:this.hasField(null===(B=Mi.solar)||void 0===B?void 0:B.secondary_info),state:null,icon:null===(N=null===(D=Mi.solar)||void 0===D?void 0:D.secondary_info)||void 0===N?void 0:N.icon,unit:null===(R=null===(z=Mi.solar)||void 0===z?void 0:z.secondary_info)||void 0===R?void 0:R.unit_of_measurement,unit_white_space:null===(H=null===(j=Mi.solar)||void 0===j?void 0:j.secondary_info)||void 0===H?void 0:H.unit_white_space}},Ti={entity:null===(F=Mi.battery)||void 0===F?void 0:F.entity,has:void 0!==(null===(I=null==Mi?void 0:Mi.battery)||void 0===I?void 0:I.entity),mainEntity:"object"==typeof(null===(W=Mi.battery)||void 0===W?void 0:W.entity)?Mi.battery.entity.consumption:null===(V=Mi.battery)||void 0===V?void 0:V.entity,name:this.computeFieldName(Mi.battery,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.battery")),icon:this.computeFieldIcon(Mi.battery,"mdi:battery-high"),state_of_charge:{state:(null===(K=null===(Z=Mi.battery)||void 0===Z?void 0:Z.state_of_charge)||void 0===K?void 0:K.length)?this.getEntityState(null===(Y=Mi.battery)||void 0===Y?void 0:Y.state_of_charge):null,unit:(null===(q=null==Mi?void 0:Mi.battery)||void 0===q?void 0:q.state_of_charge_unit)||"%",unit_white_space:(null===(J=null==Mi?void 0:Mi.battery)||void 0===J?void 0:J.state_of_charge_unit_white_space)||!0,decimals:(null===(Q=null==Mi?void 0:Mi.battery)||void 0===Q?void 0:Q.state_of_charge_decimals)||0},state:{toBattery:0,fromBattery:0,toGrid:0},color:{fromBattery:null===(tt=null===(X=Mi.battery)||void 0===X?void 0:X.color)||void 0===tt?void 0:tt.consumption,toBattery:null===(ot=null===(et=Mi.battery)||void 0===et?void 0:et.color)||void 0===ot?void 0:ot.production,icon_type:void 0,circle_type:null===(it=Mi.battery)||void 0===it?void 0:it.color_circle}},Gi={entity:null===(rt=Mi.home)||void 0===rt?void 0:rt.entity,has:void 0!==(null===(nt=null==Mi?void 0:Mi.home)||void 0===nt?void 0:nt.entity),state:null,icon:this.computeFieldIcon(null==Mi?void 0:Mi.home,"mdi:home"),name:this.computeFieldName(null==Mi?void 0:Mi.home,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.home")),color:{icon_type:null===(at=Mi.home)||void 0===at?void 0:at.color_icon},secondary:{entity:null===(st=null===(lt=Mi.home)||void 0===lt?void 0:lt.secondary_info)||void 0===st?void 0:st.entity,has:this.hasField(null===(dt=Mi.home)||void 0===dt?void 0:dt.secondary_info),state:null}},Bi=t=>{var e,o,i,r,n,a,l,s,d,c,u,v,h,y,p,m,_,f,g,b;return{entity:null===(e=Mi[t])||void 0===e?void 0:e.entity,has:this.hasField(Mi[t]),displayZero:null===(o=Mi[t])||void 0===o?void 0:o.display_zero,displayZeroTolerance:null===(i=Mi[t])||void 0===i?void 0:i.display_zero_tolerance,state:null,icon:this.computeFieldIcon(Mi[t],"individual1"===t?"mdi:car-electric":"mdi:motorbike-electric"),name:this.computeFieldName(Mi[t],"individual1"===t?"Car":"Motorcycle"),color:null===(r=Mi[t])||void 0===r?void 0:r.color,unit:null===(n=Mi[t])||void 0===n?void 0:n.unit_of_measurement,unit_white_space:null===(a=Mi[t])||void 0===a?void 0:a.unit_white_space,decimals:null===(l=Mi[t])||void 0===l?void 0:l.decimals,secondary:{entity:null===(d=null===(s=Mi[t])||void 0===s?void 0:s.secondary_info)||void 0===d?void 0:d.entity,has:this.hasField(null===(c=Mi[t])||void 0===c?void 0:c.secondary_info,!0),state:null,icon:null===(v=null===(u=Mi[t])||void 0===u?void 0:u.secondary_info)||void 0===v?void 0:v.icon,unit:null===(y=null===(h=Mi[t])||void 0===h?void 0:h.secondary_info)||void 0===y?void 0:y.unit_of_measurement,unit_white_space:null===(m=null===(p=Mi[t])||void 0===p?void 0:p.secondary_info)||void 0===m?void 0:m.unit_white_space,displayZero:null===(f=null===(_=Mi[t])||void 0===_?void 0:_.secondary_info)||void 0===f?void 0:f.display_zero,displayZeroTolerance:null===(b=null===(g=Mi[t])||void 0===g?void 0:g.secondary_info)||void 0===b?void 0:b.display_zero_tolerance}}},Di=Bi("individual1"),Ni=Bi("individual2"),zi={entity:null===(ct=Mi.fossil_fuel_percentage)||void 0===ct?void 0:ct.entity,name:(null===(ut=Mi.fossil_fuel_percentage)||void 0===ut?void 0:ut.name)||(null===(vt=Mi.fossil_fuel_percentage)||void 0===vt?void 0:vt.use_metadata)&&(null===(ht=this.getEntityStateObj(Mi.fossil_fuel_percentage.entity))||void 0===ht?void 0:ht.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.low_carbon"),icon:(null===(yt=Mi.fossil_fuel_percentage)||void 0===yt?void 0:yt.icon)||(null===(pt=Mi.fossil_fuel_percentage)||void 0===pt?void 0:pt.use_metadata)&&(null===(ft=null===(mt=this.getEntityStateObj(Mi.fossil_fuel_percentage.entity))||void 0===mt?void 0:mt.attributes)||void 0===ft?void 0:ft.icon)||"mdi:leaf",hasPower:!1,hasPercentage:void 0!==(null===(wt=Mi.fossil_fuel_percentage)||void 0===wt?void 0:wt.entity)&&!0===(null===($t=Mi.fossil_fuel_percentage)||void 0===$t?void 0:$t.display_zero)||1*(null!==(xt=Pi.state.fromGrid)&&void 0!==xt?xt:0)-this.getEntityState(null===(St=Mi.fossil_fuel_percentage)||void 0===St?void 0:St.entity)/100>0&&void 0!==(null===(Et=Mi.fossil_fuel_percentage)||void 0===Et?void 0:Et.entity)&&this.entityAvailable(null===(At=Mi.fossil_fuel_percentage)||void 0===At?void 0:At.entity),state:{power:null},color:null===(Ct=Mi.fossil_fuel_percentage)||void 0===Ct?void 0:Ct.color,secondary:{entity:null===(Pt=null===(Mt=Mi.fossil_fuel_percentage)||void 0===Mt?void 0:Mt.secondary_info)||void 0===Pt?void 0:Pt.entity,has:this.hasField(null===(Ot=Mi.fossil_fuel_percentage)||void 0===Ot?void 0:Ot.secondary_info,!0),state:null,icon:null===(Gt=null===(Tt=Mi.fossil_fuel_percentage)||void 0===Tt?void 0:Tt.secondary_info)||void 0===Gt?void 0:Gt.icon,unit:null===(Dt=null===(Bt=Mi.fossil_fuel_percentage)||void 0===Bt?void 0:Bt.secondary_info)||void 0===Dt?void 0:Dt.unit_of_measurement,unit_white_space:null===(zt=null===(Nt=Mi.fossil_fuel_percentage)||void 0===Nt?void 0:Nt.secondary_info)||void 0===zt?void 0:zt.unit_white_space}};if(this.style.setProperty("--secondary-text-solar-color",(null===(jt=null===(Rt=Mi.solar)||void 0===Rt?void 0:Rt.secondary_info)||void 0===jt?void 0:jt.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),Oi.secondary.has){const t=Number(this.hass.states[null===(Ft=null===(Ht=Mi.solar)||void 0===Ht?void 0:Ht.secondary_info)||void 0===Ft?void 0:Ft.entity].state);Oi.secondary.state=Math.max(t,0)}if(Pi.hasReturnToGrid&&("string"==typeof Mi.grid.entity?Pi.state.toGrid=this.entityInverted("grid")?Math.max(this.getEntityStateWatts(Mi.grid.entity),0):Math.abs(Math.min(this.getEntityStateWatts(Mi.grid.entity),0)):Pi.state.toGrid=this.getEntityStateWatts(null===(It=Mi.grid)||void 0===It?void 0:It.entity.production)),void 0!==(null===(Ut=Mi.solar)||void 0===Ut?void 0:Ut.color)){let t=null===(Lt=Mi.solar)||void 0===Lt?void 0:Lt.color;"object"==typeof t&&(t=this.convertColorListToHex(t)),this.style.setProperty("--energy-solar-color",t||"#ff9800")}if(this.style.setProperty("--icon-solar-color",(null===(Wt=Mi.solar)||void 0===Wt?void 0:Wt.color_icon)?"var(--energy-solar-color)":"var(--primary-text-color)"),Oi.has&&(this.entityInverted("solar")?Oi.state.total=Math.abs(Math.min(this.getEntityStateWatts(null===(Vt=Mi.solar)||void 0===Vt?void 0:Vt.entity),0)):Oi.state.total=Math.max(this.getEntityStateWatts(null===(Zt=Mi.solar)||void 0===Zt?void 0:Zt.entity),0),(null===(Kt=Mi.solar)||void 0===Kt?void 0:Kt.display_zero_tolerance)&&Mi.solar.display_zero_tolerance>=Oi.state.total&&(Oi.state.total=0)),Oi.has&&(Oi.state.toHome=(null!==(Yt=Oi.state.total)&&void 0!==Yt?Yt:0)-(null!==(qt=Pi.state.toGrid)&&void 0!==qt?qt:0)-(null!==(Jt=Ti.state.toBattery)&&void 0!==Jt?Jt:0)),null!==Oi.state.toHome&&Oi.state.toHome<0&&(Ti.has&&(Pi.state.toBattery=Math.abs(Oi.state.toHome),Pi.state.toBattery>(null!==(Qt=Pi.state.fromGrid)&&void 0!==Qt?Qt:0)&&(Ti.state.toGrid=Math.min(Pi.state.toBattery-(null!==(Xt=Pi.state.fromGrid)&&void 0!==Xt?Xt:0),0),Pi.state.toBattery=Pi.state.fromGrid)),Oi.state.toHome=0),Oi.has&&Ti.has?(Ti.state.toGrid||(Ti.state.toGrid=Math.max(0,(Pi.state.toGrid||0)-(Oi.state.total||0)-(Ti.state.toBattery||0)-(Pi.state.toBattery||0))),Oi.state.toBattery=Ti.state.toBattery-(Pi.state.toBattery||0)):!Oi.has&&Ti.has&&(Ti.state.toGrid=Pi.state.toGrid||0),Oi.has&&Pi.state.toGrid&&(Oi.state.toGrid=Pi.state.toGrid-(null!==(te=Ti.state.toGrid)&&void 0!==te?te:0)),this.style.setProperty("--text-solar-color",(null===(ee=Mi.solar)||void 0===ee?void 0:ee.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),void 0!==Pi.color.fromGrid&&"object"==typeof Pi.color.fromGrid&&(Pi.color.fromGrid=this.convertColorListToHex(Pi.color.fromGrid)),Pi.has&&("string"==typeof Mi.grid.entity?this.entityInverted("grid")?Pi.state.fromGrid=Math.abs(Math.min(this.getEntityStateWatts(null===(oe=Mi.grid)||void 0===oe?void 0:oe.entity),0)):Pi.state.fromGrid=Math.max(this.getEntityStateWatts(null===(ie=Mi.grid)||void 0===ie?void 0:ie.entity),0):Pi.state.fromGrid=this.getEntityStateWatts(Mi.grid.entity.consumption)),void 0!==(null===(re=Mi.grid)||void 0===re?void 0:re.display_zero_tolerance)&&(Pi.state.fromGrid=Pi.state.fromGrid>(null===(ne=Mi.grid)||void 0===ne?void 0:ne.display_zero_tolerance)?Pi.state.fromGrid:0),Pi.secondary.has){const t=Number(this.hass.states[null!==(se=null===(le=null===(ae=Mi.grid)||void 0===ae?void 0:ae.secondary_info)||void 0===le?void 0:le.entity)&&void 0!==se?se:0].state);Pi.secondary.state=Math.max(t,0)}void 0!==Pi.color.toGrid&&("object"==typeof Pi.color.toGrid&&(Pi.color.toGrid=this.convertColorListToHex(Pi.color.toGrid)),this.style.setProperty("--energy-grid-return-color",Pi.color.toGrid||"#a280db")),void 0!==Pi.color.fromGrid&&("object"==typeof Pi.color.fromGrid&&(Pi.color.fromGrid=this.convertColorListToHex(Pi.color.fromGrid)),this.style.setProperty("--energy-grid-consumption-color",Pi.color.fromGrid||"#a280db")),void 0!==(null===(de=Mi.grid)||void 0===de?void 0:de.display_zero_tolerance)&&(Pi.state.toGrid=Pi.state.toGrid>(null===(ce=Mi.grid)||void 0===ce?void 0:ce.display_zero_tolerance)?Pi.state.toGrid:0),this.style.setProperty("--icon-grid-color","consumption"===Pi.color.icon_type?"var(--energy-grid-consumption-color)":"production"===Pi.color.icon_type?"var(--energy-grid-return-color)":!0===Pi.color.icon_type?(null!==(ue=Pi.state.fromGrid)&&void 0!==ue?ue:0)>=(null!==(ve=Pi.state.toGrid)&&void 0!==ve?ve:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-grid-color","consumption"===Pi.secondary.color.type?"var(--energy-grid-consumption-color)":"production"===Pi.secondary.color.type?"var(--energy-grid-return-color)":!0===Pi.secondary.color.type?(null!==(he=Pi.state.fromGrid)&&void 0!==he?he:0)>=(null!==(ye=Pi.state.toGrid)&&void 0!==ye?ye:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)"),this.style.setProperty("--circle-grid-color","consumption"===Pi.color.circle_type?"var(--energy-grid-consumption-color)":"production"===Pi.color.circle_type?"var(--energy-grid-return-color)":!0===Pi.color.circle_type?(null!==(pe=Pi.state.fromGrid)&&void 0!==pe?pe:0)>=(null!==(me=Pi.state.toGrid)&&void 0!==me?me:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--energy-grid-consumption-color)");const Ri=function(t){const e=getComputedStyle(t||document.body),{width:o}=e,i=parseFloat(o);return Number.isNaN(i)?0:i}(document.getElementById("card-content"))>420;this.style.setProperty("--lines-svg-not-flat-line-height",Ri?"106%":"102%"),this.style.setProperty("--lines-svg-not-flat-line-top",Ri?"-3%":"-1%");let ji=null===(_e=Mi.individual1)||void 0===_e?void 0:_e.color;if(void 0!==ji&&("object"==typeof ji&&(ji=this.convertColorListToHex(ji)),this.style.setProperty("--individualone-color",ji)),this.style.setProperty("--icon-individualone-color",(null===(fe=Mi.individual1)||void 0===fe?void 0:fe.color_icon)?"var(--individualone-color)":"var(--primary-text-color)"),Di.has){const t=this.getEntityStateWatts(null===(ge=Mi.individual1)||void 0===ge?void 0:ge.entity);this.entityInverted("individual1")?Di.state=Math.abs(Math.min(t,0)):Di.state=Math.max(t,0)}if(Di.secondary.has){const t=this.hass.states[null===(we=null===(be=Mi.individual1)||void 0===be?void 0:be.secondary_info)||void 0===we?void 0:we.entity].state;"number"==typeof t?Di.secondary.state=Math.max(t,0):"string"==typeof t&&(Di.secondary.state=t)}if(void 0!==Ni.color&&("object"==typeof Ni.color&&(Ni.color=this.convertColorListToHex(Ni.color)),this.style.setProperty("--individualtwo-color",Ni.color)),this.style.setProperty("--icon-individualtwo-color",(null===($e=Mi.individual2)||void 0===$e?void 0:$e.color_icon)?"var(--individualtwo-color)":"var(--primary-text-color)"),Ni.has){const t=this.getEntityStateWatts(null===(xe=Mi.individual2)||void 0===xe?void 0:xe.entity);this.entityInverted("individual2")?Ni.state=Math.abs(Math.min(t,0)):Ni.state=Math.max(t,0)}if(Ni.secondary.has){const t=this.hass.states[null===(Se=null===(ke=Mi.individual2)||void 0===ke?void 0:ke.secondary_info)||void 0===Se?void 0:Se.entity].state;"number"==typeof t?Ni.secondary.state=Math.max(t,0):"string"==typeof t&&(Ni.secondary.state=t)}if(Gi.secondary.has){const t=Number(this.hass.states[null===(Ae=null===(Ee=Mi.home)||void 0===Ee?void 0:Ee.secondary_info)||void 0===Ae?void 0:Ae.entity].state);Gi.secondary.state=Math.max(t,0)}Ti.has&&("string"==typeof(null===(Ce=Mi.battery)||void 0===Ce?void 0:Ce.entity)?(Ti.state.toBattery=this.entityInverted("battery")?Math.max(this.getEntityStateWatts(Mi.battery.entity),0):Math.abs(Math.min(this.getEntityStateWatts(Mi.battery.entity),0)),Ti.state.fromBattery=this.entityInverted("battery")?Math.abs(Math.min(this.getEntityStateWatts(Mi.battery.entity),0)):Math.max(this.getEntityStateWatts(Mi.battery.entity),0)):(Ti.state.toBattery=this.getEntityStateWatts(null===(Pe=null===(Me=Mi.battery)||void 0===Me?void 0:Me.entity)||void 0===Pe?void 0:Pe.production),Ti.state.fromBattery=this.getEntityStateWatts(null===(Te=null===(Oe=Mi.battery)||void 0===Oe?void 0:Oe.entity)||void 0===Te?void 0:Te.consumption)),(null===(Ge=null==Mi?void 0:Mi.battery)||void 0===Ge?void 0:Ge.display_zero_tolerance)&&(Mi.battery.display_zero_tolerance>=Ti.state.toBattery&&(Ti.state.toBattery=0),Mi.battery.display_zero_tolerance>=Ti.state.fromBattery&&(Ti.state.fromBattery=0))),Ti.has&&(Ti.state.fromBattery=(null!==(Be=Ti.state.fromBattery)&&void 0!==Be?Be:0)-(null!==(De=Ti.state.toGrid)&&void 0!==De?De:0)),void 0!==Ti.color.fromBattery&&("object"==typeof Ti.color.fromBattery&&(Ti.color.fromBattery=this.convertColorListToHex(Ti.color.fromBattery)),this.style.setProperty("--energy-battery-out-color",Ti.color.fromBattery||"#4db6ac")),void 0!==Ti.color.toBattery&&("object"==typeof Ti.color.toBattery&&(Ti.color.toBattery=this.convertColorListToHex(Ti.color.toBattery)),this.style.setProperty("--energy-battery-in-color",Ti.color.toBattery||"#a280db")),Ti.color.icon_type=null===(Ne=Mi.battery)||void 0===Ne?void 0:Ne.color_icon,this.style.setProperty("--icon-battery-color","consumption"===Ti.color.icon_type?"var(--energy-battery-in-color)":"production"===Ti.color.icon_type?"var(--energy-battery-out-color)":!0===Ti.color.icon_type?Ti.state.fromBattery>=Ti.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)":"var(--primary-text-color)");const Hi=null===(ze=Mi.battery)||void 0===ze?void 0:ze.color_state_of_charge_value;this.style.setProperty("--text-battery-state-of-charge-color","consumption"===Hi?"var(--energy-battery-in-color)":"production"===Hi?"var(--energy-battery-out-color)":!0===Hi?Ti.state.fromBattery>=Ti.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)":"var(--primary-text-color)"),this.style.setProperty("--circle-battery-color","consumption"===Ti.color.circle_type?"var(--energy-battery-in-color)":"production"===Ti.color.circle_type||!0===Ti.color.circle_type&&Ti.state.fromBattery>=Ti.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)"),Pi.state.fromGrid=Math.max((null!==(Re=Pi.state.fromGrid)&&void 0!==Re?Re:0)-(null!==(je=Pi.state.toBattery)&&void 0!==je?je:0),0);const Fi=bt(Di.state,0)+bt(Ni.state,0),Ii=Math.max((null!==(He=Pi.state.fromGrid)&&void 0!==He?He:0)+(null!==(Fe=Oi.state.toHome)&&void 0!==Fe?Fe:0)+(null!==(Ie=Ti.state.fromBattery)&&void 0!==Ie?Ie:0),0);let Ui=0;Ti.state.fromBattery&&(Ui=kt*(Ti.state.fromBattery/Ii));let Li=0;if(Oi.has&&(Li=kt*(Oi.state.toHome/Ii)),zi.secondary.has){const t=this.hass.states[null===(Le=null===(Ue=Mi.fossil_fuel_percentage)||void 0===Ue?void 0:Ue.secondary_info)||void 0===Le?void 0:Le.entity].state;"number"==typeof t?zi.secondary.state=Math.max(t,0):"string"==typeof t&&(zi.secondary.state=t)}let Wi=0;const Vi=kt*((Ii-(null!==(We=zi.state.power)&&void 0!==We?We:0)-(null!==(Ve=Ti.state.fromBattery)&&void 0!==Ve?Ve:0)-(null!==(Ze=Oi.state.toHome)&&void 0!==Ze?Ze:0))/Ii),Zi=Pi.state.fromGrid+(null!==(Ke=Oi.state.toHome)&&void 0!==Ke?Ke:0)+(null!==(Ye=Oi.state.toGrid)&&void 0!==Ye?Ye:0)+(null!==(qe=Oi.state.toBattery)&&void 0!==qe?qe:0)+(null!==(Je=Ti.state.fromBattery)&&void 0!==Je?Je:0)+(null!==(Qe=Pi.state.toBattery)&&void 0!==Qe?Qe:0)+(null!==(Xe=Ti.state.toGrid)&&void 0!==Xe?Xe:0);null===Ti.state_of_charge.state?Ti.icon="mdi:battery":Ti.state_of_charge.state<=72&&Ti.state_of_charge.state>44?Ti.icon="mdi:battery-medium":Ti.state_of_charge.state<=44&&Ti.state_of_charge.state>16?Ti.icon="mdi:battery-low":Ti.state_of_charge.state<=16&&(Ti.icon="mdi:battery-outline"),void 0!==(null===(to=Mi.battery)||void 0===to?void 0:to.icon)&&(Ti.icon=null===(eo=Mi.battery)||void 0===eo?void 0:eo.icon);const Ki={batteryGrid:this.circleRate(null!==(io=null!==(oo=Pi.state.toBattery)&&void 0!==oo?oo:Ti.state.toGrid)&&void 0!==io?io:0,Zi),batteryToHome:this.circleRate(null!==(ro=Ti.state.fromBattery)&&void 0!==ro?ro:0,Zi),gridToHome:this.circleRate(Pi.state.fromGrid,Zi),solarToBattery:this.circleRate(null!==(no=Oi.state.toBattery)&&void 0!==no?no:0,Zi),solarToGrid:this.circleRate(null!==(ao=Oi.state.toGrid)&&void 0!==ao?ao:0,Zi),solarToHome:this.circleRate(null!==(lo=Oi.state.toHome)&&void 0!==lo?lo:0,Zi),individual1:this.circleRate(null!==(so=Di.state)&&void 0!==so?so:0,Fi),individual2:this.circleRate(null!==(co=Ni.state)&&void 0!==co?co:0,Fi),nonFossil:this.circleRate(null!==(uo=zi.state.power)&&void 0!==uo?uo:0,Zi)};["batteryGrid","batteryToHome","gridToHome","solarToBattery","solarToGrid","solarToHome"].forEach((t=>{const e=this[`${t}Flow`];e&&this.previousDur[t]&&this.previousDur[t]!==Ki[t]&&(e.pauseAnimations(),e.setCurrentTime(e.getCurrentTime()*(Ki[t]/this.previousDur[t])),e.unpauseAnimations()),this.previousDur[t]=Ki[t]})),void 0!==zi.color&&("object"==typeof zi.color&&(zi.color=this.convertColorListToHex(zi.color)),this.style.setProperty("--non-fossil-color",zi.color||"var(--energy-non-fossil-color)")),this.style.setProperty("--icon-non-fossil-color",(null===(vo=Mi.fossil_fuel_percentage)||void 0===vo?void 0:vo.color_icon)?"var(--non-fossil-color)":"var(--primary-text-color)");const Yi={battery:{value:Ui,color:"var(--energy-battery-out-color)"},solar:{value:Li,color:"var(--energy-solar-color)"},grid:{value:Vi,color:"var(--energy-grid-consumption-color)"},gridNonFossil:{value:Wi,color:"var(--energy-non-fossil-color)"}},qi=Object.keys(Yi).reduce(((t,e)=>Yi[t].value>Yi[e].value?t:e));let Ji="var(--primary-text-color)";"solar"===Gi.color.icon_type?Ji="var(--energy-solar-color)":"battery"===Gi.color.icon_type?Ji="var(--energy-battery-out-color)":"grid"===Gi.color.icon_type?Ji="var(--energy-grid-consumption-color)":!0===Gi.color.icon_type&&(Ji=Yi[qi].color),this.style.setProperty("--icon-home-color",Ji);const Qi=null===(ho=Mi.home)||void 0===ho?void 0:ho.color_value;let Xi="var(--primary-text-color)";"solar"===Qi?Xi="var(--energy-solar-color)":"battery"===Qi?Xi="var(--energy-battery-out-color)":"grid"===Qi?Xi="var(--energy-grid-consumption-color)":!0===Qi&&(Xi=Yi[qi].color);const tr=t=>void 0===t.state?"":this.displayValue(t.state,t.unit,t.unit_white_space,t.decimals),er=tr(Di),or=tr(Ni);this.style.setProperty("--text-home-color",Xi),this.style.setProperty("--text-non-fossil-color",(null===(yo=Mi.fossil_fuel_percentage)||void 0===yo?void 0:yo.color_value)?"var(--non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-non-fossil-color",(null===(mo=null===(po=Mi.fossil_fuel_percentage)||void 0===po?void 0:po.secondary_info)||void 0===mo?void 0:mo.color_value)?"var(--non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualone-color",(null===(_o=Mi.individual1)||void 0===_o?void 0:_o.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualtwo-color",(null===(fo=Mi.individual2)||void 0===fo?void 0:fo.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualone-color",(null===(bo=null===(go=Mi.individual1)||void 0===go?void 0:go.secondary_info)||void 0===bo?void 0:bo.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualtwo-color",(null===($o=null===(wo=Mi.individual2)||void 0===wo?void 0:wo.secondary_info)||void 0===$o?void 0:$o.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-home-color",(null===(ko=null===(xo=Mi.home)||void 0===xo?void 0:xo.secondary_info)||void 0===ko?void 0:ko.color_value)?"var(--text-home-color)":"var(--primary-text-color)");const ir={gridSecondary:null===(So=this._templateResults.gridSecondary)||void 0===So?void 0:So.result,solarSecondary:null===(Eo=this._templateResults.solarSecondary)||void 0===Eo?void 0:Eo.result,homeSecondary:null===(Ao=this._templateResults.homeSecondary)||void 0===Ao?void 0:Ao.result,individual1Secondary:null===(Co=this._templateResults.individual1Secondary)||void 0===Co?void 0:Co.result,individual2Secondary:null===(Mo=this._templateResults.individual2Secondary)||void 0===Mo?void 0:Mo.result,nonFossilFuelSecondary:null===(Po=this._templateResults.nonFossilFuelSecondary)||void 0===Po?void 0:Po.result},rr=(null===(Oo=Mi.home)||void 0===Oo?void 0:Oo.override_state)&&Mi.home.entity?(null===(To=Mi.home)||void 0===To?void 0:To.subtract_individual)?this.displayValue(this.getEntityStateWatts(Mi.home.entity)-Fi):this.displayValue(this.getEntityStateWatts(Mi.home.entity)):(null===(Go=Mi.home)||void 0===Go?void 0:Go.subtract_individual)?this.displayValue(Ii-Fi||0):this.displayValue(Ii);if(zi.hasPower=1*Pi.state.fromGrid-this.getEntityState(null===(Bo=Mi.fossil_fuel_percentage)||void 0===Bo?void 0:Bo.entity)/100>0&&void 0!==(null===(Do=Mi.fossil_fuel_percentage)||void 0===Do?void 0:Do.entity)&&this.entityAvailable(null===(No=Mi.fossil_fuel_percentage)||void 0===No?void 0:No.entity),zi.hasPower){const t=1-this.getEntityState(null===(zo=Mi.fossil_fuel_percentage)||void 0===zo?void 0:zo.entity)/100;zi.state.power=Pi.state.fromGrid*t,Wi=kt*(zi.state.power/Ii)}const nr=({className:t,template:e,value:o,entityId:i,icon:r})=>{var n,a;return o||e?U`<span class="secondary-info ${t}" @click="${t=>{this.openDetails(t,i)}}" @keyDown="${t=>{"Enter"===t.key&&this.openDetails(t,i)}}">${(null===(a=null===(n=Mi.solar)||void 0===n?void 0:n.secondary_info)||void 0===a?void 0:a.icon)?U`<ha-icon class="secondary-info small" .icon="${r}"></ha-icon>`:""} ${null!=e?e:o}</span>`:""},ar=(t,e)=>U`${t.secondary.has?U`${nr({className:e,entityId:t.secondary.entity,icon:t.secondary.icon,value:this.displayValue(t.secondary.state,t.secondary.unit,t.secondary.unit_white_space),template:ir.gridSecondary})}`:""}`,lr=(t,e)=>{var o,i;const r=ir[`${e}Secondary`],n=t.secondary.has?this.displayValue(t.secondary.state,t.secondary.unit,t.secondary.unit_white_space):void 0,a=!1!==t.secondary.displayZero||!gt(t.secondary.state)||(null!==(o=Number(t.secondary.state))&&void 0!==o?o:0)>(null!==(i=t.secondary.displayZeroTolerance)&&void 0!==i?i:0);return U`${t.secondary.has&&a||r?U`${nr({className:e,entityId:t.secondary.entity,icon:t.secondary.icon,value:n,template:ir[`${e}Secondary`]})}`:""}`};return U`<ha-card .header="${this._config.title}"><div class="card-content" id="card-content">${Oi.has||Ni.has||Di.has||zi.hasPercentage?U`<div class="row">${zi.hasPercentage?U`<div class="circle-container low-carbon"><span class="label">${zi.name}</span><div class="circle" @click="${t=>{var e;this.openDetails(t,null===(e=Mi.fossil_fuel_percentage)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&this.openDetails(t,null===(e=Mi.fossil_fuel_percentage)||void 0===e?void 0:e.entity)}}">${ar(zi,"nonFossilFuelSecondary")}<ha-icon .icon="${zi.icon}" class="low-carbon" style="${zi.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Ro=Mi.fossil_fuel_percentage)||void 0===Ro?void 0:Ro.display_zero_state)||(zi.state.power||0)>((null===(jo=Mi.fossil_fuel_percentage)||void 0===jo?void 0:jo.display_zero_tolerance)||0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Ho=Mi.fossil_fuel_percentage)||void 0===Ho?void 0:Ho.display_zero_state)||(zi.state.power||0)>((null===(Fo=Mi.fossil_fuel_percentage)||void 0===Fo?void 0:Fo.display_zero_tolerance)||0)?U`<span class="low-carbon">${this.displayNonFossilState(Mi.fossil_fuel_percentage.entity,Pi.state.fromGrid)}</span>`:""}</div>${this.showLine(zi.state.power||0)?U`<svg width="80" height="30"><path d="M40 -10 v40" class="low-carbon" id="low-carbon"/>${zi.hasPower?L`<circle r="2.4" class="low-carbon" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Io=Mi.fossil_fuel_percentage)||void 0===Io?void 0:Io.calculate_flow_rate,Ki.nonFossil)}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#low-carbon"></animateMotion></circle>`:""}</svg>`:""}</div>`:U`<div class="spacer"></div>`} ${Oi.has?U`<div class="circle-container solar"><span class="label">${Oi.name}</span><div class="circle" @click="${t=>{this.openDetails(t,Oi.entity)}}" @keyDown="${t=>{"Enter"===t.key&&this.openDetails(t,Oi.entity)}}">${ar(Oi,"solar")}<ha-icon id="solar-icon" .icon="${Oi.icon}" style="${Oi.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Uo=Mi.solar)||void 0===Uo?void 0:Uo.display_zero_state)||(Oi.state.total||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Lo=Mi.solar)||void 0===Lo?void 0:Lo.display_zero_state)||(Oi.state.total||0)>0?U`<span class="solar">${this.displayValue(Oi.state.total)}</span>`:""}</div></div>`:Ni.has||Di.has?U`<div class="spacer"></div>`:""} ${Ni.has?U`<div class="circle-container individual2"><span class="label">${Ni.name}</span><div class="circle" @click="${t=>{var e;this.openDetails(t,null===(e=Mi.individual2)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&this.openDetails(t,null===(e=Mi.individual2)||void 0===e?void 0:e.entity)}}">${lr(Ni,"individual2")}<ha-icon id="individual2-icon" .icon="${Ni.icon}" style="${Ni.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Wo=Mi.individual2)||void 0===Wo?void 0:Wo.display_zero_state)||(Ni.state||0)>(null!==(Vo=Ni.displayZeroTolerance)&&void 0!==Vo?Vo:0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Zo=Mi.individual2)||void 0===Zo?void 0:Zo.display_zero_state)||(Ni.state||0)>(null!==(Ko=Ni.displayZeroTolerance)&&void 0!==Ko?Ko:0)?U`<span class="individual2">${or}</span>`:""}</div>${this.showLine(Ni.state||0)?U`<svg width="80" height="30"><path d="M40 -10 v50" id="individual2"/>${Ni.state?L`<circle r="2.4" class="individual2" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Yo=Mi.individual2)||void 0===Yo?void 0:Yo.calculate_flow_rate,Ki.individual2)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${(null===(qo=Mi.individual2)||void 0===qo?void 0:qo.inverted_animation)?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual2"></animateMotion></circle>`:""}</svg>`:""}</div>`:Di.has?U`<div class="circle-container individual1"><span class="label">${Di.name}</span><div class="circle" @click="${t=>{var e;this.openDetails(t,null===(e=Mi.individual1)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&this.openDetails(t,null===(e=Mi.individual1)||void 0===e?void 0:e.entity)}}">${lr(Di,"individual1")}<ha-icon id="individual1-icon" .icon="${Di.icon}" style="${Di.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Jo=Mi.individual1)||void 0===Jo?void 0:Jo.display_zero_state)||(Di.state||0)>(null!==(Qo=Di.displayZeroTolerance)&&void 0!==Qo?Qo:0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Xo=Mi.individual1)||void 0===Xo?void 0:Xo.display_zero_state)||(Di.state||0)>(null!==(ti=Di.displayZeroTolerance)&&void 0!==ti?ti:0)?U`<span class="individual1">${er}</span>`:""}</div>${this.showLine(Di.state||0)?U`<svg width="80" height="30"><path d="M40 -10 v40" id="individual1"/>${Di.state?L`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(ei=Mi.individual1)||void 0===ei?void 0:ei.calculate_flow_rate,Ki.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${(null===(oi=Mi.individual1)||void 0===oi?void 0:oi.inverted_animation)?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:U``}</div>`:U`<div class="spacer"></div>`}</div>`:U``}<div class="row">${Pi.has?U`<div class="circle-container grid"><div class="circle" @click="${t=>{const e="string"==typeof Mi.grid.entity?Mi.grid.entity:Mi.grid.entity.consumption||Mi.grid.entity.production;this.openDetails(t,e)}}" @keyDown="${t=>{if("Enter"===t.key){const e="string"==typeof Mi.grid.entity?Mi.grid.entity:Mi.grid.entity.consumption||Mi.grid.entity.production;this.openDetails(t,e)}}}">${ar(Pi,"grid")}<ha-icon .icon="${Pi.icon}"></ha-icon>${("two_way"===(null===(ii=Mi.grid)||void 0===ii?void 0:ii.display_state)||void 0===(null===(ri=Mi.grid)||void 0===ri?void 0:ri.display_state)||"one_way"===(null===(ni=Mi.grid)||void 0===ni?void 0:ni.display_state)&&(null!==(ai=Pi.state.toGrid)&&void 0!==ai?ai:0)>0||"one_way_no_zero"===(null===(li=Mi.grid)||void 0===li?void 0:li.display_state)&&(null===Pi.state.fromGrid||0===Pi.state.fromGrid)&&0!==Pi.state.toGrid)&&null!==Pi.state.toGrid&&!Pi.powerOutage.isOutage?U`<span class="return" @click="${t=>{const e="string"==typeof Mi.grid.entity?Mi.grid.entity:Mi.grid.entity.production;this.openDetails(t,e)}}" @keyDown="${t=>{if("Enter"===t.key){const e="string"==typeof Mi.grid.entity?Mi.grid.entity:Mi.grid.entity.production;this.openDetails(t,e)}}}"><ha-icon class="small" .icon="${"mdi:arrow-left"}"></ha-icon>${this.displayValue(Pi.state.toGrid)}</span>`:null} ${("two_way"===(null===(si=Mi.grid)||void 0===si?void 0:si.display_state)||void 0===(null===(di=Mi.grid)||void 0===di?void 0:di.display_state)||"one_way"===(null===(ci=Mi.grid)||void 0===ci?void 0:ci.display_state)&&Pi.state.fromGrid>0||"one_way_no_zero"===(null===(ui=Mi.grid)||void 0===ui?void 0:ui.display_state)&&(null===Pi.state.toGrid||0===Pi.state.toGrid))&&null!==Pi.state.fromGrid&&!Pi.powerOutage.isOutage?U`<span class="consumption"><ha-icon class="small" .icon="${"mdi:arrow-right"}"></ha-icon>${this.displayValue(Pi.state.fromGrid)}</span>`:""} ${Pi.powerOutage.isOutage?U`<span class="grid power-outage">${(null===(vi=Mi.grid)||void 0===vi?void 0:vi.power_outage.label_alert)||U`Power<br>Outage`}</span>`:""}</div><span class="label">${Pi.name}</span></div>`:U`<div class="spacer"></div>`}<div class="circle-container home"><div class="circle" id="home-circle" @click="${t=>{var e;this.openDetails(t,null===(e=Mi.home)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&this.openDetails(t,null===(e=Mi.home)||void 0===e?void 0:e.entity)}}">${ar(Pi,"grid")}<ha-icon .icon="${Gi.icon}"></ha-icon>${rr} <svg class="home-circle-sections">${void 0!==Li?L`<circle class="solar" cx="40" cy="40" r="38" stroke-dasharray="${Li} ${kt-Li}" shape-rendering="geometricPrecision" stroke-dashoffset="-${kt-Li}">`:""} ${Ui?L`<circle class="battery" cx="40" cy="40" r="38" stroke-dasharray="${Ui} ${kt-Ui}" stroke-dashoffset="-${kt-Ui-(Li||0)}" shape-rendering="geometricPrecision">`:""} ${void 0!==Wi?L`<circle class="low-carbon" cx="40" cy="40" r="38" stroke-dasharray="${Wi} ${kt-Wi}" stroke-dashoffset="-${kt-Wi-(Ui||0)-(Li||0)}" shape-rendering="geometricPrecision">`:""}<circle class="grid" cx="40" cy="40" r="38" stroke-dasharray="${null!=Vi?Vi:kt-Li-(Ui||0)} ${void 0!==Vi?kt-Vi:Li+(Ui||0)}" stroke-dashoffset="0" shape-rendering="geometricPrecision"/></svg></div>${this.showLine(Di.state||0)&&Ni.has&&Di.has?"":U`<span class="label">${Gi.name}</span>`}</div></div>${Ti.has||Di.has&&Ni.has?U`<div class="row"><div class="spacer"></div>${Ti.has?U`<div class="circle-container battery"><div class="circle" @click="${t=>{var e,o,i,r,n;const a=(null===(e=Mi.battery)||void 0===e?void 0:e.state_of_charge)?null===(o=Mi.battery)||void 0===o?void 0:o.state_of_charge:"string"==typeof(null===(i=Mi.battery)||void 0===i?void 0:i.entity)?null===(r=Mi.battery)||void 0===r?void 0:r.entity:null===(n=Mi.battery)||void 0===n?void 0:n.entity.production;this.openDetails(t,a)}}" @keyDown="${t=>{var e,o;if("Enter"===t.key){const i=(null===(e=Mi.battery)||void 0===e?void 0:e.state_of_charge)?null===(o=Mi.battery)||void 0===o?void 0:o.state_of_charge:"string"==typeof Mi.battery.entity?Mi.battery.entity:Mi.battery.entity.production;this.openDetails(t,i)}}}">${null!==Ti.state_of_charge.state?U`<span @click="${t=>{var e;this.openDetails(t,null===(e=Mi.battery)||void 0===e?void 0:e.state_of_charge)}}" @keyDown="${t=>{var e;"Enter"===t.key&&this.openDetails(t,null===(e=Mi.battery)||void 0===e?void 0:e.state_of_charge)}}" id="battery-state-of-charge-text">${this.displayValue(Ti.state_of_charge.state,Ti.state_of_charge.unit,Ti.state_of_charge.unit_white_space,Ti.state_of_charge.decimals)}</span>`:null}<ha-icon .icon="${Ti.icon}" style="${"two_way"===(null===(hi=Mi.battery)||void 0===hi?void 0:hi.display_state)?"padding-top: 0px; padding-bottom: 2px;":"one_way"===(null===(yi=Mi.battery)||void 0===yi?void 0:yi.display_state)&&0===Ti.state.toBattery&&0===Ti.state.fromBattery?"padding-top: 2px; padding-bottom: 0px;":"padding-top: 2px; padding-bottom: 2px;"}" @click="${t=>{var e;this.openDetails(t,null===(e=Mi.battery)||void 0===e?void 0:e.state_of_charge)}}" @keyDown="${t=>{var e;"Enter"===t.key&&this.openDetails(t,null===(e=Mi.battery)||void 0===e?void 0:e.state_of_charge)}}"></ha-icon>${"two_way"===(null===(pi=Mi.battery)||void 0===pi?void 0:pi.display_state)||void 0===(null===(mi=Mi.battery)||void 0===mi?void 0:mi.display_state)||"one_way"===(null===(_i=Mi.battery)||void 0===_i?void 0:_i.display_state)&&Ti.state.toBattery>0||"one_way_no_zero"===(null===(fi=Mi.battery)||void 0===fi?void 0:fi.display_state)&&0!==Ti.state.toBattery?U`<span class="battery-in" @click="${t=>{const e="string"==typeof Mi.battery.entity?Mi.battery.entity:Mi.battery.entity.production;this.openDetails(t,e)}}" @keyDown="${t=>{if("Enter"===t.key){const e="string"==typeof Mi.battery.entity?Mi.battery.entity:Mi.battery.entity.production;this.openDetails(t,e)}}}"><ha-icon class="small" .icon="${"mdi:arrow-down"}"></ha-icon>${this.displayValue(Ti.state.toBattery)}</span>`:""} ${"two_way"===(null===(gi=Mi.battery)||void 0===gi?void 0:gi.display_state)||void 0===(null===(bi=Mi.battery)||void 0===bi?void 0:bi.display_state)||"one_way"===(null===(wi=Mi.battery)||void 0===wi?void 0:wi.display_state)&&Ti.state.fromBattery>0||"one_way_no_zero"===(null===($i=Mi.battery)||void 0===$i?void 0:$i.display_state)&&(0===Ti.state.toBattery||0!==Ti.state.fromBattery)?U`<span class="battery-out" @click="${t=>{const e="string"==typeof Mi.battery.entity?Mi.battery.entity:Mi.battery.entity.consumption;this.openDetails(t,e)}}" @keyDown="${t=>{if("Enter"===t.key){const e="string"==typeof Mi.battery.entity?Mi.battery.entity:Mi.battery.entity.consumption;this.openDetails(t,e)}}}"><ha-icon class="small" .icon="${"mdi:arrow-up"}"></ha-icon>${this.displayValue(Ti.state.fromBattery)}</span>`:""}</div><span class="label">${Ti.name}</span></div>`:U`<div class="spacer"></div>`} ${Ni.has&&Di.has?U`<div class="circle-container individual1 bottom">${this.showLine(Di.state||0)?U`<svg width="80" height="30"><path d="M40 40 v-40" id="individual1"/>${Di.state?L`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(xi=Mi.individual1)||void 0===xi?void 0:xi.calculate_flow_rate,Ki.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${(null===(ki=Mi.individual1)||void 0===ki?void 0:ki.inverted_animation)?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:U`<svg width="80" height="30"></svg>`}<div class="circle" @click="${t=>{var e;this.openDetails(t,null===(e=Mi.individual1)||void 0===e?void 0:e.entity)}}" @keyDown="${t=>{var e;"Enter"===t.key&&this.openDetails(t,null===(e=Mi.individual1)||void 0===e?void 0:e.entity)}}">${lr(Di,"individual1")}<ha-icon id="individual1-icon" .icon="${Di.icon}" style="${Di.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Si=Mi.individual1)||void 0===Si?void 0:Si.display_zero_state)||(Di.state||0)>(null!==(Ei=Di.displayZeroTolerance)&&void 0!==Ei?Ei:0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Ai=Mi.individual1)||void 0===Ai?void 0:Ai.display_zero_state)||(Di.state||0)>(null!==(Ci=Di.displayZeroTolerance)&&void 0!==Ci?Ci:0)?U`<span class="individual1">${er}</span>`:""}</div><span class="label">${Di.name}</span></div>`:U`<div class="spacer"></div>`}</div>`:U`<div class="spacer"></div>`} ${Oi.has&&this.showLine(Oi.state.toHome||0)?U`<div class="lines ${_t({high:Ti.has,"individual1-individual2":!Ti.has&&Ni.has&&Di.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-home-flow"><path id="solar" class="solar" d="M${Ti.has?55:53},0 v${Pi.has?15:17} c0,${Ti.has?"30 10,30 30,30":"35 10,35 30,35"} h25" vector-effect="non-scaling-stroke"></path>${Oi.state.toHome?L`<circle r="1" class="solar" vector-effect="non-scaling-stroke"><animateMotion dur="${Ki.solarToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#solar"></animateMotion></circle>`:""}</svg></div>`:""} ${Pi.hasReturnToGrid&&Oi.has&&this.showLine(Oi.state.toGrid||0)?U`<div class="lines ${_t({high:Ti.has,"individual1-individual2":!Ti.has&&Ni.has&&Di.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-grid-flow"><path id="return" class="return" d="M${Ti.has?45:47},0 v15 c0,${Ti.has?"30 -10,30 -30,30":"35 -10,35 -30,35"} h-20" vector-effect="non-scaling-stroke"></path>${Oi.state.toGrid&&Oi.has?L`<circle r="1" class="return" vector-effect="non-scaling-stroke"><animateMotion dur="${Ki.solarToGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#return"></animateMotion></circle>`:""}</svg></div>`:""} ${Ti.has&&Oi.has&&this.showLine(Oi.state.toBattery||0)?U`<div class="lines ${_t({high:Ti.has,"individual1-individual2":!Ti.has&&Ni.has&&Di.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-battery-flow" class="flat-line"><path id="battery-solar" class="battery-solar" d="M50,0 V100" vector-effect="non-scaling-stroke"></path>${Oi.state.toBattery?L`<circle r="1" class="battery-solar" vector-effect="non-scaling-stroke"><animateMotion dur="${Ki.solarToBattery}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-solar"></animateMotion></circle>`:""}</svg></div>`:""} ${Pi.has&&this.showLine(Pi.state.fromGrid)?U`<div class="lines ${_t({high:Ti.has,"individual1-individual2":!Ti.has&&Ni.has&&Di.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="grid-home-flow" class="flat-line"><path class="grid" id="grid" d="M0,${Ti.has?50:Oi.has?56:53} H100" vector-effect="non-scaling-stroke"></path>${Pi.state.fromGrid?L`<circle r="1" class="grid" vector-effect="non-scaling-stroke"><animateMotion dur="${Ki.gridToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#grid"></animateMotion></circle>`:""}</svg></div>`:null} ${Ti.has&&this.showLine(Ti.state.fromBattery)?U`<div class="lines ${_t({high:Ti.has,"individual1-individual2":!Ti.has&&Ni.has&&Di.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-home-flow"><path id="battery-home" class="battery-home" d="M55,100 v-${Pi.has?15:17} c0,-30 10,-30 30,-30 h20" vector-effect="non-scaling-stroke"></path>${Ti.state.fromBattery?L`<circle r="1" class="battery-home" vector-effect="non-scaling-stroke"><animateMotion dur="${Ki.batteryToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-home"></animateMotion></circle>`:""}</svg></div>`:""} ${Pi.has&&Ti.has&&this.showLine(Math.max(Pi.state.toBattery||0,Ti.state.toGrid||0))?U`<div class="lines ${_t({high:Ti.has,"individual1-individual2":!Ti.has&&Ni.has&&Di.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-grid-flow"><path id="battery-grid" class="${_t({"battery-from-grid":Boolean(Pi.state.toBattery),"battery-to-grid":Boolean(Ti.state.toGrid)})}" d="M45,100 v-15 c0,-30 -10,-30 -30,-30 h-20" vector-effect="non-scaling-stroke"></path>${Pi.state.toBattery?L`<circle r="1" class="battery-from-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${Ki.batteryGrid}s" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""} ${Ti.state.toGrid?L`<circle r="1" class="battery-to-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${Ki.batteryGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""}</svg></div>`:""}</div>${this._config.dashboard_link?U`<div class="card-actions"><a href="${this._config.dashboard_link}"><mwc-button>${this._config.dashboard_link_label||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.go_to_energy_dashboard")}</mwc-button></a></div>`:""}</ha-card>`}updated(t){super.updated(t),this._config&&this.hass&&this._tryConnectAll()}_tryConnectAll(){var t,e,o,i,r,n,a,l,s,d,c,u;const{entities:v}=this._config,h={gridSecondary:null===(e=null===(t=v.grid)||void 0===t?void 0:t.secondary_info)||void 0===e?void 0:e.template,solarSecondary:null===(i=null===(o=v.solar)||void 0===o?void 0:o.secondary_info)||void 0===i?void 0:i.template,homeSecondary:null===(n=null===(r=v.home)||void 0===r?void 0:r.secondary_info)||void 0===n?void 0:n.template,individual1Secondary:null===(l=null===(a=v.individual1)||void 0===a?void 0:a.secondary_info)||void 0===l?void 0:l.template,individual2Secondary:null===(d=null===(s=v.individual2)||void 0===s?void 0:s.secondary_info)||void 0===d?void 0:d.template,nonFossilFuelSecondary:null===(u=null===(c=v.fossil_fuel_percentage)||void 0===c?void 0:c.secondary_info)||void 0===u?void 0:u.template};for(const[t,e]of Object.entries(h))e&&this._tryConnect(e,t)}async _tryConnect(t,e){var o,i,r,n,a,l;if(this.hass&&this._config&&void 0===(null===(o=this._unsubRenderTemplates)||void 0===o?void 0:o.get(e))&&""!==t)try{const o=(n=this.hass.connection,a=t=>{this._templateResults[e]=t},l={template:t,entity_ids:this._config.entity_id,variables:{config:this._config,user:this.hass.user.name},strict:!0},n.subscribeMessage((t=>a(t)),Object.assign({type:"render_template"},l)));null===(i=this._unsubRenderTemplates)||void 0===i||i.set(e,o),await o}catch(o){this._templateResults=Object.assign(Object.assign({},this._templateResults),{[e]:{result:t,listeners:{all:!1,domains:[],entities:[],time:!1}}}),null===(r=this._unsubRenderTemplates)||void 0===r||r.delete(e)}}async _tryDisconnectAll(){var t,e,o,i,r,n,a,l,s,d;const{entities:c}=this._config,u={gridSecondary:null===(e=null===(t=c.grid)||void 0===t?void 0:t.secondary_info)||void 0===e?void 0:e.template,solarSecondary:null===(i=null===(o=c.solar)||void 0===o?void 0:o.secondary_info)||void 0===i?void 0:i.template,homeSecondary:null===(n=null===(r=c.home)||void 0===r?void 0:r.secondary_info)||void 0===n?void 0:n.template,individual1Secondary:null===(l=null===(a=c.individual1)||void 0===a?void 0:a.secondary_info)||void 0===l?void 0:l.template,individual2Secondary:null===(d=null===(s=c.individual2)||void 0===s?void 0:s.secondary_info)||void 0===d?void 0:d.template};for(const[t,e]of Object.entries(u))e&&this._tryDisconnect(t)}async _tryDisconnect(t){var e,o;const i=null===(e=this._unsubRenderTemplates)||void 0===e?void 0:e.get(t);if(i)try{(await i)(),null===(o=this._unsubRenderTemplates)||void 0===o||o.delete(t)}catch(t){if("not_found"!==t.code&&"template_error"!==t.code)throw t}}};St.styles=xt,t([vt({attribute:!1})],St.prototype,"hass",void 0),t([ht()],St.prototype,"_config",void 0),t([ht()],St.prototype,"_templateResults",void 0),t([ht()],St.prototype,"_unsubRenderTemplate",void 0),t([ht()],St.prototype,"_unsubRenderTemplates",void 0),t([yt("#battery-grid-flow")],St.prototype,"batteryGridFlow",void 0),t([yt("#battery-home-flow")],St.prototype,"batteryToHomeFlow",void 0),t([yt("#grid-home-flow")],St.prototype,"gridToHomeFlow",void 0),t([yt("#solar-battery-flow")],St.prototype,"solarToBatteryFlow",void 0),t([yt("#solar-grid-flow")],St.prototype,"solarToGridFlow",void 0),t([yt("#solar-home-flow")],St.prototype,"solarToHomeFlow",void 0),St=t([ct("power-flow-card-plus")],St);class Et extends TypeError{constructor(t,e){let o;const{message:i,explanation:r,...n}=t,{path:a}=t,l=0===a.length?i:`At path: ${a.join(".")} -- ${i}`;super(r??l),null!=r&&(this.cause=l),Object.assign(this,n),this.name=this.constructor.name,this.failures=()=>o??(o=[t,...e()])}}function At(t){return"object"==typeof t&&null!=t}function Ct(t){return"symbol"==typeof t?t.toString():"string"==typeof t?JSON.stringify(t):`${t}`}function Mt(t,e,o,i){if(!0===t)return;!1===t?t={}:"string"==typeof t&&(t={message:t});const{path:r,branch:n}=e,{type:a}=o,{refinement:l,message:s=`Expected a value of type \`${a}\`${l?` with refinement \`${l}\``:""}, but received: \`${Ct(i)}\``}=t;return{value:i,type:a,refinement:l,key:r[r.length-1],path:r,branch:n,...t,message:s}}function*Pt(t,e,o,i){(function(t){return At(t)&&"function"==typeof t[Symbol.iterator]})(t)||(t=[t]);for(const r of t){const t=Mt(r,e,o,i);t&&(yield t)}}function*Ot(t,e,o={}){const{path:i=[],branch:r=[t],coerce:n=!1,mask:a=!1}=o,l={path:i,branch:r};if(n&&(t=e.coercer(t,l),a&&"type"!==e.type&&At(e.schema)&&At(t)&&!Array.isArray(t)))for(const o in t)void 0===e.schema[o]&&delete t[o];let s="valid";for(const i of e.validator(t,l))i.explanation=o.message,s="not_valid",yield[i,void 0];for(let[d,c,u]of e.entries(t,l)){const e=Ot(c,u,{path:void 0===d?i:[...i,d],branch:void 0===d?r:[...r,c],coerce:n,mask:a,message:o.message});for(const o of e)o[0]?(s=null!=o[0].refinement?"not_refined":"not_valid",yield[o[0],void 0]):n&&(c=o[1],void 0===d?t=c:t instanceof Map?t.set(d,c):t instanceof Set?t.add(c):At(t)&&(void 0!==c||d in t)&&(t[d]=c))}if("not_valid"!==s)for(const i of e.refiner(t,l))i.explanation=o.message,s="not_refined",yield[i,void 0];"valid"===s&&(yield[void 0,t])}class Tt{constructor(t){const{type:e,schema:o,validator:i,refiner:r,coercer:n=(t=>t),entries:a=function*(){}}=t;this.type=e,this.schema=o,this.entries=a,this.coercer=n,this.validator=i?(t,e)=>Pt(i(t,e),e,this,t):()=>[],this.refiner=r?(t,e)=>Pt(r(t,e),e,this,t):()=>[]}assert(t,e){return Gt(t,this,e)}create(t,e){return function(t,e,o){const i=Bt(t,e,{coerce:!0,message:o});if(i[0])throw i[0];return i[1]}(t,this,e)}is(t){return function(t,e){return!Bt(t,e)[0]}(t,this)}mask(t,e){return function(t,e,o){const i=Bt(t,e,{coerce:!0,mask:!0,message:o});if(i[0])throw i[0];return i[1]}(t,this,e)}validate(t,e={}){return Bt(t,this,e)}}function Gt(t,e,o){const i=Bt(t,e,{message:o});if(i[0])throw i[0]}function Bt(t,e,o={}){const i=Ot(t,e,o),r=function(t){const{done:e,value:o}=t.next();return e?void 0:o}(i);if(r[0]){return[new Et(r[0],(function*(){for(const t of i)t[0]&&(yield t[0])})),void 0]}return[void 0,r[1]]}function Dt(t,e){return new Tt({type:t,schema:null,validator:e})}function Nt(){return Dt("any",(()=>!0))}function zt(){return Dt("boolean",(t=>"boolean"==typeof t))}function Rt(){return Dt("integer",(t=>"number"==typeof t&&!isNaN(t)&&Number.isInteger(t)||`Expected an integer, but received: ${Ct(t)}`))}function jt(){return Dt("number",(t=>"number"==typeof t&&!isNaN(t)||`Expected a number, but received: ${Ct(t)}`))}function Ht(t){const e=t?Object.keys(t):[],o=Dt("never",(()=>!1));return new Tt({type:"object",schema:t||null,*entries(i){if(t&&At(i)){const r=new Set(Object.keys(i));for(const o of e)r.delete(o),yield[o,i[o],t[o]];for(const t of r)yield[t,i[t],o]}},validator:t=>At(t)||`Expected an object, but received: ${Ct(t)}`,coercer:t=>At(t)?{...t}:t})}function Ft(t){return new Tt({...t,validator:(e,o)=>void 0===e||t.validator(e,o),refiner:(e,o)=>void 0===e||t.refiner(e,o)})}function It(){return Dt("string",(t=>"string"==typeof t||`Expected a string, but received: ${Ct(t)}`))}function Ut(t){return{type:"expandable",title:`Combined ${t||"Grid"} Entity (positive & negative values)`,schema:[{name:"entity",selector:{entity:{}}}]}}function Lt(t){return{type:"expandable",title:`Separated ${t||"Grid"} Entities (One for production, one for consumption)`,name:"entity",schema:[{name:"consumption",label:"Consumption Entity",selector:{entity:{}}},{name:"production",label:"Production Entity",selector:{entity:{}}}]}}const Wt={name:"color",title:"Custom Colors",type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"consumption",label:"Consumption",selector:{color_rgb:{}}},{name:"production",label:"Production",selector:{color_rgb:{}}}]}]},Vt=[{name:"entity",selector:{entity:{}}},{name:"template",label:"Template (overrides entity, save to update)",selector:{template:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"icon",selector:{icon:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}}]}],Zt=[{name:"color_icon",label:"Color of Icon",selector:{select:{options:[{value:!1,label:"Do not Color"},{value:!0,label:"Color dynamically"},{value:"production",label:"Production"},{value:"consumption",label:"Consumption"}],custom_value:!0}}},{name:"color_circle",label:"Color of Circle",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{min:0,max:1e6,step:1,mode:"box"}}},{name:"display_state",label:"Display State",selector:{select:{options:[{value:"two_way",label:"Two Way"},{value:"one_way",label:"One Way"},{value:"one_way_no_zero",label:"One Way (Show Zero)"}],custom_value:!0}}}];function Kt(t){const e={type:"grid",column_min_width:"200px",schema:[{name:"name",selector:{text:{}}},{name:"icon",selector:{icon:{}}}]};return"battery"!==t&&"grid"!==t||e.schema.push(...Zt),e}const Yt=Object.assign(Object.assign({},Kt("grid")),{schema:[...Kt("grid").schema,{name:"invert_state",label:"Invert State",selector:{boolean:{}}}]}),qt=[Ut(),Lt(),Yt,Wt,{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:Vt},{title:"Power Outage",name:"power_outage",type:"expandable",schema:[{name:"entity",selector:{entity:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"label_alert",label:"Outage Label",selector:{text:{}}},{name:"icon_alert",label:"Outage Icon",selector:{icon:{}}},{name:"state_alert",label:"Outage State",selector:{text:{}}}]}]}],Jt=Object.assign(Object.assign({},Kt("battery")),{schema:[...Kt("battery").schema,{name:"invert_state",label:"Invert State",selector:{boolean:{}}}]}),Qt=[Ut("battery"),Lt("battery"),{title:"State of Charge",name:"",type:"expandable",schema:[{name:"state_of_charge",label:"State of Charge Entity",selector:{entity:{}}},{name:"",type:"grid",column_min_width:"200px",schema:[{name:"state_of_charge_unit",label:"Unit",selector:{text:{}}},{name:"state_of_charge_unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"state_of_charge_decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}},{name:"color_state_of_charge_value",label:"Color of Value",selector:{select:{options:[{value:!1,label:"Do Not Color"},{value:!0,label:"Color dynamically"},{value:"consumption",label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}}]}]},Jt,Wt],Xt=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},Kt()),{schema:[...Kt().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero_state",label:"Display State When Zero?",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:Vt}],te=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},Kt()),{schema:[...Kt().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"inverted_animation",label:"Invert Animation",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}},{name:"calculate_flow_rate",label:"Calculate Flow Rate",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:Vt}],ee=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},Kt()),{schema:[...Kt().schema,{name:"state_type",label:"State Type",selector:{select:{options:[{value:"power",label:"Power"},{value:"percentage",label:"Percentage"}],custom_value:!0}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:Vt}],oe=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},Kt()),{schema:[...Kt().schema,{name:"color_value",label:"Color Value",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"color_icon",label:"Color Icon",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"subtract_individual",label:"Subtract Individual",selector:{boolean:{}}},{name:"override_state",label:"Override State (With Home Entity)",selector:{boolean:{}}}]}),{title:"Secondary Info",name:"secondary_info",type:"expandable",schema:Vt}],ie=function(...t){const e="type"===t[0].type,o=t.map((t=>t.schema)),i=Object.assign({},...o);return e?function(t){const e=Object.keys(t);return new Tt({type:"type",schema:t,*entries(o){if(At(o))for(const i of e)yield[i,o[i],t[i]]},validator:t=>At(t)||`Expected an object, but received: ${Ct(t)}`,coercer:t=>At(t)?{...t}:t})}(i):Ht(i)}(Ht({type:It(),view_layout:Nt()}),Ht({title:Ft(It()),theme:Ft(It()),dashboard_link:Ft(It()),dashboard_link_label:Ft(It()),inverted_entities:Ft(Nt()),w_decimals:Ft(Rt()),kw_decimals:Ft(Rt()),min_flow_rate:Ft(jt()),max_flow_rate:Ft(jt()),min_expected_power:Ft(jt()),max_expected_power:Ft(jt()),watt_threshold:Ft(jt()),clickable_entities:Ft(zt()),display_zero_lines:Ft(zt()),use_new_flow_rate_model:Ft(zt()),entities:Ht({battery:Ft(Nt()),grid:Ft(Nt()),solar:Ft(Nt()),home:Ft(Nt()),fossil_fuel_percentage:Ft(Nt()),individual1:Ft(Nt()),individual2:Ft(Nt())})})),re=[{name:"title",label:"Title",selector:{text:{}}}],ne=[{name:"entities",type:"grid",column_min_width:"400px",schema:[{title:"Grid",name:"grid",type:"expandable",schema:qt},{title:"Solar",name:"solar",type:"expandable",schema:Xt},{title:"Battery",name:"battery",type:"expandable",schema:Qt},{title:"Non-Fossil",name:"fossil_fuel_percentage",type:"expandable",schema:ee},{title:"Home",name:"home",type:"expandable",schema:oe},{title:"Individual 1",name:"individual1",type:"expandable",schema:te},{title:"Individual 2",name:"individual2",type:"expandable",schema:te}]}],ae=[{title:"Advanced Options",type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"dashboard_link",label:"Dashboard Link",selector:{navigation:{}}},{name:"dashboard_link_label",label:"Dashboard Link Label",selector:{text:{}}},{name:"w_decimals",label:"Watt Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"kw_decimals",label:"kW Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"max_flow_rate",label:"Max Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_flow_rate",label:"Min Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"max_expected_power",label:"Max Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_expected_power",label:"Min Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"watt_threshold",label:"Watt to Kilowatt Threshold",selector:{number:{mode:"box",min:0,max:1e6,step:1}}},{name:"display_zero_lines",label:"Display Zero Lines",selector:{boolean:{}}},{name:"clickable_entities",label:"Clickable Entities",selector:{boolean:{}}},{name:"use_new_flow_rate_model",label:"New Flow Model?",selector:{boolean:{}}}]}]}],le=async()=>{var t,e;if(customElements.get("ha-form"))return;const o=await(null===(e=(t=window).loadCardHelpers)||void 0===e?void 0:e.call(t));if(!o)return;const i=await o.createCardElement({type:"entity"});i&&await i.getConfigElement()};let se=class extends st{constructor(){super(...arguments),this.showOther=!1,this._computeLabelCallback=t=>(null==t?void 0:t.label)||this.hass.localize(`ui.panel.lovelace.editor.card.generic.${null==t?void 0:t.name}`||(null==t?void 0:t.name)||"")}async setConfig(t){Gt(t,ie),this._config=t}connectedCallback(){super.connectedCallback(),le()}render(){if(!this.hass||!this._config)return V;const t=Object.assign({},this._config);return U`<div class="card-config"><ha-form .hass="${this.hass}" .data="${t}" .schema="${re}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${t}" .schema="${ne}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}" class="entities-section"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${t}" .schema="${ae}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form></div>`}_valueChanged(t){const e=t.detail.value||"";this._config&&this.hass&&function(t,e,o,i){i=i||{},o=null==o?{}:o;var r=new Event("config-changed",{bubbles:void 0===i.bubbles||i.bubbles,cancelable:Boolean(i.cancelable),composed:void 0===i.composed||i.composed});r.detail=o,t.dispatchEvent(r)}(this,0,{config:e})}static get styles(){return u`ha-form{width:100%}ha-icon-button{align-self:center}.entities-section *{background-color:red}.card-config{display:flex;flex-direction:column;justify-content:space-between;align-items:center;margin-bottom:10px}.config-header{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.config-header.sub-header{margin-top:24px}ha-icon{padding-bottom:2px;position:relative;top:-4px;right:1px}`}};t([vt({attribute:!1})],se.prototype,"hass",void 0),t([ht()],se.prototype,"_config",void 0),t([ht()],se.prototype,"showOther",void 0),se=t([ct("power-flow-card-plus-editor")],se);var de=Object.freeze({__proto__:null,loadHaForm:le,get PowerFlowCardPlusEditor(){return se}});export{St as PowerFlowCardPlus};
